<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kay Haw&#39;s Blog Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kay Haw&#39;s Blog Blog Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">Hadoop 3.xå­¦ä¹ ç¬”è®°(3) | Kay Haw&#x27;s Blog</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://kayhaw.github.io/blog/2022/01/31/Learning-Hadoop3.x-03"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Hadoop 3.xå­¦ä¹ ç¬”è®°(3) | Kay Haw&#x27;s Blog"><meta data-react-helmet="true" name="description" content="Hadoop 3.1.3å­¦ä¹ ç¬”è®°(3)"><meta data-react-helmet="true" property="og:description" content="Hadoop 3.1.3å­¦ä¹ ç¬”è®°(3)"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-01-31T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/kayhaw"><meta data-react-helmet="true" property="article:tag" content="Hadoop,BigData"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://kayhaw.github.io/blog/2022/01/31/Learning-Hadoop3.x-03"><link data-react-helmet="true" rel="alternate" href="https://kayhaw.github.io/blog/2022/01/31/Learning-Hadoop3.x-03" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://kayhaw.github.io/blog/2022/01/31/Learning-Hadoop3.x-03" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.0138175c.css">
<link rel="preload" href="/assets/js/runtime~main.ed6f7924.js" as="script">
<link rel="preload" href="/assets/js/main.87f14a62.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Kay Haw&#x27;s Blog" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Kay Haw&#x27;s Blog" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Kay Haw&#x27;s Blog</b></a><a class="navbar__item navbar__link" href="/docs/intro">è¯»ä¹¦ç¬”è®°</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kayhaw" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2022/02/10/Learning-Hadoop3.x-06">Hadoop 3.xå­¦ä¹ ç¬”è®°(6)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2022/02/07/Learning-Hadoop3.x-04">Hadoop 3.xå­¦ä¹ ç¬”è®°(4)</a></li><li class="sidebarItem_2UVv"><a aria-current="page" class="sidebarItemLink_1RT6 sidebarItemLinkActive_12pM" href="/blog/2022/01/31/Learning-Hadoop3.x-03">Hadoop 3.xå­¦ä¹ ç¬”è®°(3)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2022/01/30/Learning-Hadoop3.x-02">Hadoop 3.xå­¦ä¹ ç¬”è®°(2)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2022/01/29/Learning-Hadoop3.x-01">Hadoop 3.xå­¦ä¹ ç¬”è®°(1)</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_GeHD" itemprop="headline">Hadoop 3.xå­¦ä¹ ç¬”è®°(3)</h1><div class="blogPostData_291c margin-vert--md"><time datetime="2022-01-31T00:00:00.000Z" itemprop="datePublished">January 31, 2022</time> Â· 5 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://github.com/kayhaw" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://avatars.githubusercontent.com/u/16892835?v=4" alt="ä½•è½²"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/kayhaw" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">ä½•è½²</span></a></div><small class="avatar__subtitle" itemprop="description">Never settle down</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>ğŸ“Hadoop 3.1.3å­¦ä¹ ç¬”è®°ç¬¬3ç¯‡ï¼šMapReduceã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="mapreduceç®€ä»‹"></a>MapReduceç®€ä»‹<a class="hash-link" href="#mapreduceç®€ä»‹" title="Direct link to heading">#</a></h2><p>MapReduceæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼è¿ç®—ç¨‹åºçš„ç¼–ç¨‹æ¡†æ¶ï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯å°†ç”¨æˆ·ç¼–å†™çš„ä¸šåŠ¡é€»è¾‘ä»£ç å’Œè‡ªå¸¦ç»„ä»¶æ•´åˆæˆå®Œæ•´çš„åˆ†å¸ƒå¼è¿ç®—ç¨‹åºï¼Œç„¶ååœ¨Hadoopé›†ç¾¤ä¸Šå¹¶å‘è¿è¡Œã€‚</p><p>ä¼˜ç‚¹ğŸ˜„ï¼š</p><ol><li>æ˜“äºç¼–ç¨‹ï¼Œç”¨æˆ·åªéœ€è¦å…³ç³»ä¸šåŠ¡é€»è¾‘ï¼›</li><li>æ‰©å±•æ€§å¥½ï¼Œå¯ä»¥åŠ¨æ€å¢åŠ æœåŠ¡å™¨ï¼›</li><li>é«˜å®¹é”™æ€§ï¼Œè®¡ç®—èŠ‚ç‚¹æŒ‚ç‚¹å¯ä»¥å°†ä»»åŠ¡è½¬ç§»åˆ°å…¶ä»–èŠ‚ç‚¹ï¼›</li><li>é€‚åˆæµ·é‡æ•°æ®è®¡ç®—(TB/PB)ã€‚</li></ol><p>ç¼ºç‚¹ğŸ˜ ï¼š</p><ol><li>ä¸é€‚åˆå®æ—¶è®¡ç®—ï¼›</li><li>ä¸é€‚åˆæµå¼è®¡ç®—ï¼›</li><li>ä¸é€‚åˆDAGæœ‰å‘æ— ç¯å›¾è®¡ç®—ã€‚</li></ol><p>MapReduceç¨‹åºåˆ†ä¸º2ä¸ªé˜¶æ®µï¼šMapé˜¶æ®µå’ŒReduceé˜¶æ®µã€‚Mapé˜¶æ®µçš„MapTaskå¹¶å‘è¿è¡Œäº’ä¸ç›¸å¹²ï¼ŒReduceé˜¶æ®µçš„ReduceTaskä¹Ÿäº’ä¸ç›¸å…³ï¼Œä½†ä¾èµ–äºMapTaskçš„è¾“å‡ºã€‚MapReduceç¨‹åºåªèƒ½åŒ…å«ä¸€ä¸ªMapé˜¶æ®µå’Œä¸€ä¸ªReduceé˜¶æ®µï¼Œå¦‚æœä¸šåŠ¡é€»è¾‘éå¸¸å¤æ‚ï¼Œé‚£ä¹ˆåªèƒ½å¤šä¸ªMapReduceç¨‹åºä¸²è¡Œæ‰§è¡Œã€‚</p><p>MRç¨‹åºç¼–å†™åˆ†ä¸º3éƒ¨åˆ†ï¼šMapperã€Reducerå’ŒDriverã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="mapperç±»"></a>Mapperç±»<a class="hash-link" href="#mapperç±»" title="Direct link to heading">#</a></h3><ol><li>è‡ªå®šä¹‰ç±»ç»§æ‰¿<code>org.apache.hadoop.mapreduce.Mapper</code>ç±»ï¼›</li><li>å®šä¹‰è¾“å…¥K-Væ³›å‹ï¼Œå³æ³›å‹å‚æ•°åˆ—è¡¨çš„ç¬¬1ã€2ä¸ªå‚æ•°ï¼›</li><li>å®šä¹‰è¾“å‡ºK-Væ³›å‹ï¼Œå³æ³›å‹åˆ—è¡¨çš„ç¬¬3ã€4ä¸ªå‚æ•°ï¼›</li><li>mapæ–¹æ³•ä¸­å®ç°ä¸šåŠ¡é€»è¾‘ï¼›</li><li><strong>map()æ–¹æ³•ï¼ˆMapTaskè¿›ç¨‹ï¼‰å¯¹æ¯ä¸€ä¸ªK-Vå¯¹è°ƒç”¨ä¸€æ¬¡</strong>ã€‚</li></ol><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">WordCountMapper.java</div><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">public class WordCountMapper extends Mapper&lt;LongWritable, Text, Text, IntWritable&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å‡å°‘å¯¹è±¡åˆ›å»ºæ¬¡æ•°ï¼Œä¸è¦æ”¾åˆ°mapé‡Œé¢</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Text outK = new Text();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    private IntWritable outV = new IntWritable(1);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 1. è·å–ä¸€è¡Œ</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        String line = value.toString();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 2. åˆ‡åˆ†</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        String[] words = line.split(&quot; &quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 3. å¾ªç¯å†™å‡º</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (String word : words) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            outK.set(word);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            context.write(outK, outV);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="reducerç±»"></a>Reducerç±»<a class="hash-link" href="#reducerç±»" title="Direct link to heading">#</a></h3><ol><li>è‡ªå®šä¹‰ç±»ç»§æ‰¿<code>org.apache.hadoop.mapreduce.Reducer</code>ç±»ï¼›</li><li>è¾“å…¥K-Væ³›å‹æ˜¯å¯¹åº”Mapperçš„è¾“å‡ºK-Væ³›å‹ï¼›</li><li>reduceæ–¹æ³•å®ç°ä¸šåŠ¡é€»è¾‘ï¼›</li><li><strong>ReduceTaskè¿›ç¨‹å¯¹æ¯ä¸€ç»„ç›¸åŒkeyçš„K-Vç»„è°ƒç”¨ä¸€æ¬¡reduce()æ–¹æ³•</strong>ã€‚</li></ol><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">WordCountReducer.java</div><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">public class WordCountReducer extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    private IntWritable outV = new IntWritable();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        InterruptedException {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        int sum = 0;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (IntWritable value : values) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            sum += value.get();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        outV.set(sum);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        context.write(key, outV);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="driverç±»"></a>Driverç±»<a class="hash-link" href="#driverç±»" title="Direct link to heading">#</a></h3><p>ç›¸å½“äºYARNé›†ç¾¤çš„å®¢æˆ·ç«¯ï¼Œç”¨äºæäº¤MRä»»åŠ¡åˆ°YARNé›†ç¾¤ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">public class WordCountDriver {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws IOException, ClassNotFoundException, InterruptedException {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 1. è·å–Job</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Configuration conf = new Configuration();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Job job = Job.getInstance(conf);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 2. è®¾ç½®jarè·¯å¾„</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        job.setJarByClass(WordCountDriver.class);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 3. å…³è”mapperå’Œreducer</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        job.setMapperClass(WordCountMapper.class);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        job.setReducerClass(WordCountReducer.class);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 4. è®¾ç½®mapperè¾“å‡ºKVç±»å‹</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        job.setMapOutputKeyClass(Text.class);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        job.setMapOutputValueClass(IntWritable.class);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 5. è®¾ç½®æœ€ç»ˆè¾“å‡ºçš„KVç±»å‹</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        job.setOutputKeyClass(Text.class);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        job.setOutputValueClass(IntWritable.class);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 6. è®¾ç½®è¾“å…¥è¾“å‡ºè·¯å¾„</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileInputFormat.setInputPaths(job, new Path(&quot;wcinput\\words.txt&quot;));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileOutputFormat.setOutputPath(job, new Path(&quot;wcoutput&quot;));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 7. æäº¤Job</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        boolean result = job.waitForCompletion(true);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.exit(result ? 0 : 1);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>æ³¨æ„</h5></div><div class="admonition-content"><ol><li>æ³¨æ„å¯¼å…¥org.apache.hadoop.mapreduce.*è€Œä¸æ˜¯org.apache.hadoop.mapred.*ï¼Œå‰è€…æ˜¯Hadoop 2.x/3.xä½¿ç”¨ï¼Œåè€…æ˜¯Hadoop 1.xï¼›</li><li>WordCountDriverä¸­è®¾ç½®è¾“å‡ºKVç±»å‹ä»£ç å†™é”™ï¼Œå¯¼è‡´ç±»å‹ä¸ä¸€è‡´æŠ¥é”™ã€‚</li></ol></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="åºåˆ—åŒ–"></a>åºåˆ—åŒ–<a class="hash-link" href="#åºåˆ—åŒ–" title="Direct link to heading">#</a></h2><p>åºåˆ—åŒ–æ˜¯å°†å†…å­˜ä¸­å¯¹è±¡è½¬ä¸ºå­—èŠ‚åºåˆ—ä»¥ä¾¿äºæŒä¹…åŒ–å’Œç½‘ç»œä¼ è¾“çš„è¿‡ç¨‹ï¼Œååºåˆ—åŒ–æ˜¯å°†å­—èŠ‚åºåˆ—è½¬ä¸ºå†…å­˜ä¸­å¯¹è±¡çš„è¿‡ç¨‹ã€‚Javaåºåˆ—åŒ–æœºåˆ¶(Serializable)è¿‡äºé‡é‡ï¼Œé™„å¸¦æ ¡éªŒä¿¡æ¯ã€Headerã€ç»§æ‰¿ä½“ç³»ç­‰ï¼Œä¸ä¾¿äºç½‘ç»œä¸­é«˜æ•ˆä¼ è¾“ï¼Œå› æ­¤Hadoopè‡ªå®šä¹‰äº†åºåˆ—åŒ–æœºåˆ¶(Writable)ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p><ol><li>ç´§å‡‘ï¼šé«˜æ•ˆä½¿ç”¨å­˜å‚¨ç©ºé—´ï¼›</li><li>å¿«é€Ÿï¼šè¯»å†™æ•°æ®å¼€é”€å°ï¼›</li><li>äº’æ“ä½œï¼šæ”¯æŒå¤šè¯­è¨€äº¤äº’ã€‚</li></ol><p>å¯¹äºJavaä¸­çš„åŸºæœ¬ç±»å‹ï¼ŒHadoopæä¾›å¦‚ä¸‹å¯¹åº”åºåˆ—åŒ–ç±»ï¼š</p><table><thead><tr><th>Javaç±»å‹</th><th>Hadoop Writableç±»å‹</th></tr></thead><tbody><tr><td>Boolean</td><td>BooleanWritable</td></tr><tr><td>Byte</td><td>ByteWritable</td></tr><tr><td>Int</td><td>IntWritable</td></tr><tr><td>Float</td><td>FloatWritable</td></tr><tr><td>Long</td><td>LongWritable</td></tr><tr><td>Double</td><td>DoubleWritable</td></tr><tr><td>String</td><td>Text</td></tr><tr><td>Map</td><td>MapWritable</td></tr><tr><td>Array</td><td>ArrayWritable</td></tr><tr><td>Null</td><td>NullWritable</td></tr></tbody></table><p>æ„å»ºç¬¦åˆHadoopåºåˆ—åŒ–æœºåˆ¶çš„Beanç±»éœ€è¦æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼š</p><ol><li>å®ç°Writableæ¥å£ï¼›</li><li>æä¾›ä¸€ä¸ªç©ºå‚æ„é€ å™¨(åºåˆ—åŒ–åå°„æ—¶ç”¨)ï¼›</li><li>é‡å†™writeå’ŒreadFieldsæ–¹æ³•ï¼Œ<strong>æ³¨æ„å­—æ®µè¯»å†™é¡ºåºä¸€è‡´</strong>ï¼›</li><li><strong>å½“Beanç±»ä½œä¸ºKeyä½¿ç”¨æ—¶è¿˜éœ€è¦å®ç°Comparableæ¥å£</strong>(Shuffleè¿‡ç¨‹ä½¿ç”¨)ï¼›</li><li>å½“éœ€è¦åºåˆ—åŒ–åˆ°æ–‡ä»¶æ—¶éœ€è¦é‡å†™toStringæ–¹æ³•ã€‚</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="mapreduceæ¡†æ¶"></a>MapReduceæ¡†æ¶<a class="hash-link" href="#mapreduceæ¡†æ¶" title="Direct link to heading">#</a></h2><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒMRæ¡†æ¶åŒ…å«4ä¸ªç»„ä»¶ï¼šInputFormatã€Mapperã€Reducerå’ŒOutputFormatã€‚MapReduceç¨‹åºæ‰§è¡Œæµç¨‹ä¸ºï¼šç”±InputFormatå°†è¾“å…¥æ•°æ®åˆ†ä¸ºåˆ‡ç‰‡(Split)ï¼ŒMapperè°ƒç”¨mapæ–¹æ³•å¤„ç†æ¯ä¸ªåˆ‡ç‰‡ä¸­æ•°æ®ï¼Œé€šè¿‡Shuffleå°†å¤„ç†åç»“æœäº¤ç»™Reducerï¼Œå®ƒåˆè°ƒç”¨reduceæ–¹æ³•åˆå¹¶åˆ‡ç‰‡ç»“æœï¼Œæœ€åé€šè¿‡OutputFormatå°†åˆå¹¶ç»“æœè¾“å‡ºã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="jobæäº¤æµç¨‹"></a>Jobæäº¤æµç¨‹<a class="hash-link" href="#jobæäº¤æµç¨‹" title="Direct link to heading">#</a></h3><p>åœ¨WordCountDriverä¸­è°ƒç”¨waitForCompletionæ–¹æ³•æ¥æäº¤ä½œä¸šå¹¶è·å–ç»“æœï¼Œè¯¥æ–¹æ³•è°ƒç”¨æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>è°ƒç”¨submitæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>è°ƒç”¨ensureStateæ–¹æ³•åˆ¤æ–­å½“å‰æäº¤çŠ¶æ€ï¼Œå¿…é¡»æ˜¯JobState.DEFINEï¼›</li><li>è°ƒç”¨setUseNewAPIæ–¹æ³•å¤„ç†æ–°è€mapreduce APIçš„å…¼å®¹æ€§ï¼›</li><li>è°ƒç”¨connectæ–¹æ³•åˆ›å»ºClusterå¯¹è±¡ï¼Œè¯¥ç±»çš„æ„é€ æ–¹æ³•è°ƒç”¨initializeæ–¹æ³•ï¼Œè¯¥æ–¹æ³•åˆä¾æ¬¡éå†YarnClientProtocolProviderå’ŒLocalClientProtocolProviderï¼Œç¡®å®šå®¢æˆ·ç«¯ä¸ºLocalJobRunnerï¼›</li><li>è°ƒç”¨submitJobInternalæ–¹æ³•ã€‚</li></ol></li><li><p>å±•å¼€åˆ†æsubmitJobInternalæ–¹æ³•æµç¨‹ï¼š</p><ol><li>è°ƒç”¨checkSpecsæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è°ƒç”¨OutputFormatçš„checkOutputSpecsæ–¹æ³•æ£€æŸ¥è¾“å‡ºé…ç½®(<strong>å¯¹äºFileOutputFormatæ¥è¯´å®ƒæ£€æŸ¥è¾“å‡ºè·¯å¾„ä¸èƒ½ä¸ºç©ºå¹¶ä¸”ä¸èƒ½å·²ç»å­˜åœ¨</strong>)ï¼›</li><li>è°ƒç”¨JobSubmissionFiles.getStagingDir()æ–¹æ³•ç”Ÿæˆä¸€ä¸ªstageæ–‡ä»¶å¤¹ï¼›</li><li>è°ƒç”¨ClientProtocol.getNewJobID()ç”ŸæˆjobIdï¼›</li><li>stageè·¯å¾„å’ŒjobIdç»„æˆè·¯å¾„submitJobDir(ä¾‹å¦‚/tmp/hadoop/mapred/staging/xiaok1378532364/.staging/job_local1378532364_0001)ï¼›</li><li>é€šè¿‡è°ƒç”¨é“¾copyAndConfigureFiles-&gt;uploadResources-&gt;uploadResourcesInternalæ–¹æ³•ï¼Œè¿›è¡Œç”ŸæˆsubmitJobDiræ–‡ä»¶å¤¹ï¼Œå°†ç¨‹åºjaråŒ…ä¸Šä¼ åˆ°é›†ç¾¤(uploadJobJar)ç­‰æ“ä½œï¼›</li><li>è°ƒç”¨InputFormatçš„writeSplitsæ–¹æ³•å¾—åˆ°åˆ‡ç‰‡æ•°mapsï¼Œåœ¨submitJobDirä¸‹ç”Ÿæˆåˆ‡ç‰‡ä¿¡æ¯æ–‡ä»¶(<code>.job.split.crc</code>ã€<code>.job.splitmetainfo.crc</code>ã€<code>job.split</code>ã€<code>job.splitmetainfo</code>)ï¼Œéšåå°†åˆ‡ç‰‡æ•°è®¾ç½®åˆ°Configurationä¸­ï¼›</li><li>è°ƒç”¨writeConfæ–¹æ³•ï¼Œåœ¨submitJobDirä¸‹ç”Ÿæˆ<code>job.xml</code>(åŒ…å«æœ¬æ¬¡ä½œä¸šæ‰§è¡Œæ‰€æœ‰çš„é…ç½®ä¿¡æ¯)å’Œ<code>.job.xml.crc</code>ï¼›</li><li>è°ƒç”¨ClientProtocol.submitJobæ–¹æ³•æäº¤ä½œä¸šï¼›</li></ol></li><li><p>å°†stateè®¾ç½®ä¸ºJobState.RUNNINGï¼Œå›åˆ°waitForCompletionï¼›</p></li><li><p>æœ€åè¿”å›isSuccessful()æ–¹æ³•ç»“æœã€‚</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="fileinputformatåˆ‡ç‰‡"></a>FileInputFormatåˆ‡ç‰‡<a class="hash-link" href="#fileinputformatåˆ‡ç‰‡" title="Direct link to heading">#</a></h3><p>writeSplitsæ–¹æ³•æ ¹æ®æ˜¯å¦ä½¿ç”¨æ–°MapReduce APIé€‰æ‹©è°ƒç”¨writeNewSplitsæ–¹æ³•æˆ–è€…writeOldSplitsï¼Œè¿™é‡Œåˆ†æwriteNewSplitsä»£ç ï¼Œå®ƒè°ƒç”¨InputFormatçš„getSplitsæŠ½è±¡æ–¹æ³•ã€‚æŠ½è±¡ç±»InputFormatçš„å„ä¸ªå­ç±»xxxInputFormatä¼šå®ç°getSplitsæ–¹æ³•ï¼Œä»¥FileInputFormatçš„getSplitsæ–¹æ³•ä¸ºä¾‹åˆ†æå¦‚ä¸‹ï¼š</p><ol><li>è·å¾—minSize=1ï¼ŒmaxSize=Long.MAX_VALUEï¼›</li><li>å¾ªç¯éå†è¾“å…¥è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶æ‰§è¡Œæ­¥éª¤3-6ï¼›</li><li>ç”±isSplitableæ–¹æ³•åˆ¤æ–­è¯¥æ–‡ä»¶æ˜¯å¦å¯åˆ‡ç‰‡ï¼ŒFileInputFormaté»˜è®¤ä¸ºtrueï¼›</li><li>è·å–å—å¤§å°blockSizeï¼Œé»˜è®¤æ˜¯33554432(æœ¬åœ°è°ƒè¯•ä¸º32MB)ï¼›</li><li>è®¡ç®—åˆ‡ç‰‡å¤§å°splitSize=Math.max(minSize, Math.min(maxSize, blockSize))ï¼Œå› æ­¤é»˜è®¤åˆ‡ç‰‡å¤§å°å°±æ˜¯å—å¤§å°ï¼›</li><li>whileå¾ªç¯ç”Ÿæˆåˆ‡ç‰‡ä¿¡æ¯InputSplitåˆ—è¡¨ï¼Œæ³¨æ„åªæœ‰å‰©ä½™é•¿åº¦/splitSizeå¤§äºSPLIT_SLOP(é»˜è®¤0.1)æ—¶æ‰ä¼šåˆ‡ç‰‡ã€‚</li></ol><p>æ¥ç€è°ƒç”¨JobSplitWriter.createSplitFilesåœ¨subJobDirä¸­ç”Ÿæˆåˆ‡ç‰‡è§„åˆ’æ–‡ä»¶ï¼Œå°†å…¶æäº¤åˆ°YARNä¸Šåï¼ŒMrAppMasteræ ¹æ®åˆ‡ç‰‡è§„åˆ’æ–‡ä»¶æ¥è®¡ç®—MapTaskä¸ªæ•°ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="textinputformatå’Œcombinefileinputformat"></a>TextInputFormatå’ŒCombineFileInputFormat<a class="hash-link" href="#textinputformatå’Œcombinefileinputformat" title="Direct link to heading">#</a></h3><p>FileInputFormatæŠ½è±¡ç±»ä¸‹é’ˆå¯¹ä¸åŒä½¿ç”¨åœºæ™¯æ´¾ç”Ÿäº†NLineInputFormatã€TextInputFormatã€CombineFileInputFormatã€KeyValueTextInputFormatç­‰å­ç±»ï¼Œæœ¬èŠ‚ä»‹ç»å¸¸ç”¨çš„TextInputFormatå’ŒCombineFileInputFormatã€‚</p><p>TextInputFormatæ˜¯FileInputFormatçš„é»˜è®¤å®ç°ç±»ï¼Œæºç å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">public class TextInputFormat extends FileInputFormat&lt;LongWritable, Text&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  public RecordReader&lt;LongWritable, Text&gt; </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    createRecordReader(InputSplit split,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                       TaskAttemptContext context) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    String delimiter = context.getConfiguration().get(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;textinputformat.record.delimiter&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] recordDelimiterBytes = null;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (null != delimiter)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      recordDelimiterBytes = delimiter.getBytes(Charsets.UTF_8);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new LineRecordReader(recordDelimiterBytes);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  protected boolean isSplitable(JobContext context, Path file) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    final CompressionCodec codec =</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      new CompressionCodecFactory(context.getConfiguration()).getCodec(file);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (null == codec) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      return true;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return codec instanceof SplittableCompressionCodec;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>TextInputFormatåˆ‡ç‰‡æŒ‰ç…§æ–‡ä»¶ä¸€ä¸ªä¸€ä¸ªæ¥ï¼Œä¸ç®¡æ–‡ä»¶æœ‰å¤šå°éƒ½è‡³å°‘æ˜¯ä¸€ä¸ªåˆ‡ç‰‡ï¼Œå¯¹äºå¤§é‡å°æ–‡ä»¶è€Œè¨€è¿™å›äº§ç”Ÿå¤§é‡MapTaské™ä½å¤„ç†æ•ˆç‡ã€‚è€ŒCombineFileInputFormatç”¨äºå¤„ç†è¿™ç§å¤§é‡å°æ–‡ä»¶çš„æƒ…å†µï¼Œé€šè¿‡CombineTextInputFormat.setMaxInputSplitSizeè®¾ç½®è™šæ‹Ÿå­˜å‚¨åˆ‡ç‰‡å¤§å°maxInputSplitSizeï¼Œå¹¶æŒ‰ç…§å¦‚ä¸‹è¿‡ç¨‹åˆ‡ç‰‡ï¼š</p><ol><li>å¾ªç¯éå†è¾“å…¥æ–‡ä»¶ï¼Œå¾—åˆ°æ–‡ä»¶å¤§å°fileSizeï¼›</li><li>fileSize &lt; maxInputSplitSizeï¼Œé€»è¾‘ä¸Šåˆ’åˆ†ä¸ºä¸€å—è™šæ‹Ÿå­˜å‚¨ï¼›</li><li>2 * maxInputSplitSize &lt; fileSizeï¼Œä»¥maxInputSplitSizeåˆ‡åˆ†ä¸€å—ï¼›</li><li>maxInputSplitSize &lt; fileSize &lt;  2 * maxInputSplitSizeï¼Œå¹³å‡åˆ†æˆ2å—ï¼›</li><li>éå†æ‰€æœ‰è™šæ‹Ÿå­˜å‚¨å—ï¼Œåˆ¤æ–­å¤§å°virtBlockSizeæ˜¯å¦å¤§äºmaxInputSplitSize</li><li>virtBlockSizeå¤§äºç­‰äºmaxInputSplitSizeï¼Œå½¢æˆä¸€ä¸ªåˆ‡ç‰‡ï¼›</li><li>virtBlockSizeå°äºmaxInputSplitSizeï¼Œä¸ä¸‹ä¸€ä¸ªè™šæ‹Ÿå­˜å‚¨å—åˆå¹¶å½¢æˆä¸€ä¸ªåˆ‡ç‰‡ã€‚</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="shuffle"></a>Shuffle<a class="hash-link" href="#shuffle" title="Direct link to heading">#</a></h3><p>mapæ–¹æ³•ä¹‹åreduceæ–¹æ³•ä¹‹å‰çš„æ•°æ®å¤„ç†è¿‡ç¨‹ï¼ŒåŒ…å«åˆ†åŒºã€æ’åºã€Combinerç­‰æ“ä½œã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="åˆ†åŒºç­–ç•¥"></a>åˆ†åŒºç­–ç•¥<a class="hash-link" href="#åˆ†åŒºç­–ç•¥" title="Direct link to heading">#</a></h4><p>å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œå½“æœªé€šè¿‡<code>Job.setNumReduceTasks(int tasks)</code>è®¾ç½®ä»»åŠ¡æ•°é‡æ—¶ï¼Œé»˜è®¤partitionsä¸º1ï¼Œæ­¤æ—¶getPartitionè¿”å›0ï¼Œå³åªæœ‰ä¸€ä¸ªåˆ†åŒºã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">NewOutputCollector(org.apache.hadoop.mapreduce.JobContext jobContext,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                       JobConf job,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                       TaskUmbilicalProtocol umbilical,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                       TaskReporter reporter</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                       ) throws IOException, ClassNotFoundException {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  collector = createSortingCollector(job, reporter);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  partitions = jobContext.getNumReduceTasks();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (partitions &gt; 1) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    partitioner = (org.apache.hadoop.mapreduce.Partitioner&lt;K,V&gt;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ReflectionUtils.newInstance(jobContext.getPartitionerClass(), job);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  } else {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    partitioner = new org.apache.hadoop.mapreduce.Partitioner&lt;K,V&gt;() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      public int getPartition(K key, V value, int numPartitions) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return partitions - 1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è‹¥è®¾ç½®æ•°é‡å¤§äº1ï¼Œåˆ™é€šè¿‡getPartitionerClass()æ–¹æ³•è·å–åˆ†åŒºç±»å¹¶é€šè¿‡åå°„å®ä¾‹åŒ–ï¼Œé»˜è®¤ä½¿ç”¨HashPartitionerï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‚æ•°<code>mapreduce.job.partitioner.class</code>æŒ‡å®šã€‚æ­¤æ—¶è·å–åˆ†åŒºç¼–å·é€šè¿‡keyçš„hashå€¼å¯¹ä»»åŠ¡æ•°é‡å–æ¨¡å¾—åˆ°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">HashPartitioner.java</div><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">public class HashPartitioner&lt;K, V&gt; extends Partitioner&lt;K, V&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  /** Use {@link Object#hashCode()} to partition. */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  public int getPartition(K key, V value,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                          int numReduceTasks) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return (key.hashCode() &amp; Integer.MAX_VALUE) % numReduceTasks;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å› æ­¤ï¼Œè‡ªå®šä¹‰åˆ†åŒºç­–ç•¥æœ‰å¦‚ä¸‹3æ­¥ï¼š</p><ol><li>è‡ªå®šä¹‰CustomPartitionerç±»ç»§æ‰¿PartitioneræŠ½è±¡ç±»ï¼Œå®ç°getPartitionæŠ½è±¡æ–¹æ³•ï¼›</li><li>åœ¨é©±åŠ¨ç±»ä¸­æ³¨å†Œä½¿ç”¨ï¼Œ<code>job.setPartitionerClass(CustomPartitioner.class)</code>ï¼›</li><li>è®¾ç½®reduceä»»åŠ¡æ•°é‡ï¼Œ<code>job.setNumReduceTasks(2)</code>ã€‚</li></ol><p>æ³¨æ„getPartitionæ–¹æ³•è¿”å›çš„åˆ†åŒºå·å¿…é¡»ä»0å¼€å§‹ï¼Œé€ä¸€å¢åŠ ã€‚å¦‚æœè®¾ç½®reduceä»»åŠ¡æ•°é‡å’ŒgetPartitionè¿”å›å€¼ä¸åŒï¼Œæ ¹æ®ä¸¤è€…å…³ç³»æœ‰å¦‚ä¸‹æƒ…å†µï¼š</p><ol><li>å¦‚æœreduceä»»åŠ¡æ•°é‡å¤§äºgetPartitionè¿”å›çš„æœ€å¤§å€¼ï¼Œåˆ™äº§ç”Ÿç©ºçš„è¾“å‡ºæ–‡ä»¶part-r-000xxï¼›</li><li>å¦‚æœ1 &lt; reduceä»»åŠ¡æ•°é‡ &lt; getPartitionæ•°é‡ï¼Œåˆ™æŠ›å‡ºIOExceptionå¼‚å¸¸ï¼›</li><li>å¦‚æœreduceä»»åŠ¡æ•°é‡ä¸º1ï¼Œåˆ™åªç”Ÿæˆä¸€ä¸ªè¾“å‡ºæ–‡ä»¶part-r-00000ã€‚</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="æ’åº"></a>æ’åº<a class="hash-link" href="#æ’åº" title="Direct link to heading">#</a></h4><p>MapTaskå’ŒReduceTaskå‡ä¼šå¯¹æ•°æ®æŒ‰ç…§keyè¿›è¡Œæ’åºï¼Œè¿™æ˜¯Hadoopçš„é»˜è®¤è¡Œä¸ºï¼Œä¸ç®¡ç¨‹åºé€»è¾‘ä¸Šæ˜¯å¦éœ€è¦ã€‚</p><p>å¯¹äºMapTaskï¼Œå®ƒä¼šå°†å¤„ç†çš„ç»“æœæš‚æ—¶æ”¾åˆ°ç¯å½¢ç¼“å†²åŒºä¸­ï¼Œå½“ç¯å½¢ç¼“å†²åŒºä½¿ç”¨ç‡è¾¾åˆ°ä¸€å®šé˜ˆå€¼åï¼Œå†å¯¹ç¼“å†²åŒºä¸­çš„æ•°æ®è¿›è¡Œä¸€æ¬¡å¿«é€Ÿæ’åºï¼Œå¹¶å°†è¿™äº›æœ‰åºæ•°æ®æº¢å†™åˆ°ç£ç›˜ä¸Šï¼Œè€Œå½“æ•°æ®å¤„ç†å®Œæ¯•åï¼Œå®ƒä¼šå¯¹ç£ç›˜ä¸Šæ‰€æœ‰æ–‡ä»¶è¿›è¡Œå½’å¹¶æ’åºã€‚</p><p>å¯¹äºReduceTaskï¼Œå®ƒä»æ¯ä¸ªMapTaskä¸Šè¿œç¨‹æ‹·è´ç›¸åº”çš„æ•°æ®æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶å¤§å°è¶…è¿‡ä¸€å®šé˜ˆå€¼ï¼Œåˆ™æº¢å†™ç£ç›˜ä¸Šï¼Œå¦åˆ™å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚å¦‚æœç£ç›˜ä¸Šæ–‡ä»¶æ•°ç›®è¾¾åˆ°ä¸€å®šé˜ˆå€¼ï¼Œåˆ™è¿›è¡Œä¸€æ¬¡å½’å¹¶æ’åºä»¥ç”Ÿæˆä¸€ä¸ªæ›´å¤§æ–‡ä»¶ï¼›å¦‚æœå†…å­˜ä¸­æ–‡ä»¶å¤§å°æˆ–è€…æ•°ç›®è¶…è¿‡ä¸€å®šé˜ˆå€¼ï¼Œåˆ™è¿›è¡Œä¸€æ¬¡åˆå¹¶åå°†æ•°æ®æº¢å†™åˆ°ç£ç›˜ä¸Šã€‚å½“æ‰€æœ‰æ•°æ®æ‹·è´å®Œæ¯•åï¼ŒReduceTaskç»Ÿä¸€å¯¹å†…å­˜å’Œç£ç›˜ä¸Šçš„æ‰€æœ‰æ•°æ®è¿›è¡Œä¸€æ¬¡å½’å¹¶æ’åºã€‚</p><p>æ’åºè¦æ±‚keyç±»å‹å®ç°WritableComparableæ¥å£ï¼Œå³åœ¨Writableæ¥å£çš„åŸºç¡€ä¸Šå®ç°Comparableæ¥å£ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="combiner"></a>Combiner<a class="hash-link" href="#combiner" title="Direct link to heading">#</a></h4><p>Combinerä½œä¸ºReducerçš„å­ç±»ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„Reducerã€‚Combineråœ¨æ¯ä¸€ä¸ªMapTaskæ‰€åœ¨çš„èŠ‚ç‚¹è¿è¡Œï¼Œè€ŒReduceræ¥æ”¶å…¨å±€æ‰€æœ‰Mapperçš„è¾“å‡ºç»“æœã€‚Combinerå¯¹æ¯ä¸ªMapTaskçš„è¾“å‡ºè¿›è¡Œå±€éƒ¨æ±‡æ€»ï¼Œä»¥å‡å°‘ç½‘ç»œä¼ è¾“é‡ã€‚<strong>æ³¨æ„ä½¿ç”¨Combinerçš„å‰ææ˜¯ä¸å½±å“æœ€ç»ˆçš„ä¸šåŠ¡é€»è¾‘(æ¯”å¦‚è®¡ç®—å¹³å‡æ•°å°±ä¸è¡Œ)</strong>ï¼Œè¾“å‡ºK-Vå’ŒReducerçš„è¾“å…¥K-VåŒ¹é…ã€‚</p><p>è®¾ç½®setNumReduceTasksä¸º0ï¼ŒShuffleé˜¶æ®µä¸å­˜åœ¨ï¼Œå› æ­¤Combinerä¹Ÿä¸ç”Ÿæ•ˆã€‚ä¸šåŠ¡é€»è¾‘ç›¸åŒçš„å¯ä»¥ç›´æ¥ä½¿ç”¨Reducerä½œä¸ºCombinerã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="maptaskå·¥ä½œæœºåˆ¶"></a>MapTaskå·¥ä½œæœºåˆ¶<a class="hash-link" href="#maptaskå·¥ä½œæœºåˆ¶" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="maptaskæºç åˆ†æ"></a>MapTaskæºç åˆ†æ<a class="hash-link" href="#maptaskæºç åˆ†æ" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">è‡ªå®šä¹‰Mapperç±»çš„mapæ–¹æ³•è°ƒç”¨`context.write(key, v)`ï¼›</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    WrappedMapper.write(k, v);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    TaskInputOutputContextImpl.write(k, v);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MapTask.write(k, v, partitioner.getPartition(key, value, partitions))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        é»˜è®¤ä½¿ç”¨HashPartitionerçš„getPartitionæ–¹æ³•</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MapTask.collect()æ–¹æ³•å°†æ‰€æœ‰K-Vå†™å‡º</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    å›åˆ°runNewMapperæ–¹æ³•ä¸­è°ƒç”¨output.close() [MapTask.java, Line 805]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        è°ƒç”¨collector.flush() [MapTask.java, Line 735]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            è°ƒç”¨sortAndSpill()æ–¹æ³• [MapTask.java, Line 1505]ï¼Œ</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                è°ƒç”¨sorter.sort()æ–¹æ³• [MapTask.java, Line 1625]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            è°ƒç”¨mergeParts()æ–¹æ³•åˆå¹¶æ–‡ä»¶ [MapTask.java, Line 1527]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        è°ƒç”¨collector.close()ï¼Œå…³é—­æ”¶é›†å™¨ï¼Œè¿›å…¥ReduceTask [MapTask.java, Line 739]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="reducetaskæºç åˆ†æ"></a>ReduceTaskæºç åˆ†æ<a class="hash-link" href="#reducetaskæºç åˆ†æ" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">ä»¥ReduceTask.run()ä¸ºå…¥å£</span></span><span class="token-line" style="color:#393A34"><span class="token plain">initialize() [ReduceTask.java, Line333]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">shuffleConsumerPlugin.init(shuffleContext) [ReduceTask.java, Line 375]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    new ShuffleSchedulerImpl [Shuffle.java, Line77]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        totalMaps = job.getNumMapTasks() [ShuffleSchedulerImpl.java, Line 120]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    merger = createMergeManager(context) [Shuffle.java, Line 80]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        new MergeManagerImpl [Shuffle.java, Line 85]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.inMemoryMerger = createInMemoryMerger() [MergeManagerImpl.java, Line 232]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.onDiskMerger = new OnDiskMerger(this) [MergeManagerImpl.java, Line 235]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">rIter = shuffleConsumerPlugin.run() [ReduceTask.java, Line 375]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    eventFetcher.start()  [å¼€å§‹æŠ“å–æ•°æ®ï¼ŒShuffle.java, Line 107]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    eventFetcher.shutDown() [æŠ“å–å®Œæ¯•ï¼ŒShuffle.java, Line 141]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    copyPhase.complete() [copyå®ŒæˆShuffle.java, Line 151]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    taskStatus.setPhase(TaskStatus.Phase.SORT) [å¼€å§‹æ’åºé˜¶æ®µï¼ŒShuffle.java, Line 152]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">sortPhase.complete() [æ’åºé˜¶æ®µå®Œæˆï¼Œè¿›å…¥reduceï¼ŒReduceTask.java, Line 382]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">runNewReducer() [è¿›å…¥reducerï¼ŒReduceTask.java, Line 390]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    reducer.run() [ReduceTask.java, Line 628]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        setup(); [Reduce.java, Line 168]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        reduce(); [Reduce.java, Line 171]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        cleanup(); [[Reduce.java, Line 179]]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="join"></a>Join<a class="hash-link" href="#join" title="Direct link to heading">#</a></h2><p>MapReduceç¨‹åºçš„Joinæ“ä½œåˆ†ä¸ºReduce Joinå’ŒMap Joinä¸¤ç§ï¼š</p><ul><li><strong>Reduce Join</strong>ï¼šmapæ–¹æ³•å¯¹è®°å½•æ‰“æ ‡ç­¾ï¼Œä»¥è¿æ¥å­—æ®µä¸ºkeyï¼Œå…¶ä½™å­—æ®µåŠ æ ‡ç­¾ä¸ºvalueï¼›reduceæ–¹æ³•é€šè¿‡æ ‡ç­¾åŒºåˆ†ä¸åŒæ¥æºï¼Œç„¶ååˆå¹¶ã€‚ç¼ºç‚¹æ˜¯æ‰€æœ‰åˆå¹¶æ“ä½œåœ¨Reduceé˜¶æ®µå®Œæˆï¼ŒMapé˜¶æ®µå‹åŠ›å°ä½†Reduceé˜¶æ®µå‹åŠ›å¤§ï¼Œå®¹æ˜“äº§ç”Ÿ<strong>æ•°æ®å€¾æ–œ</strong>ï¼›</li><li><strong>Map Join</strong>ï¼šåœ¨Mapé˜¶æ®µç¼“å­˜å¤šå¼ è¡¨ï¼Œæå‰å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œ<strong>é€‚åˆå°è¡¨å…³è”å¤§è¡¨</strong>ã€‚
å‰è€…é€šè¿‡æ‰“æ ‡ç­¾æ¥åŒºåˆ†ä¸åŒæ¥æºçš„è®°å½•ï¼Œç„¶åç”¨è¿æ¥å­—æ®µä¸ºkeyï¼Œå…¶ä½™éƒ¨åˆ†åŠ æ ‡ç­¾ä¸ºvalueè¿›è¡Œreduceè¾“å‡ºã€‚å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</li></ul><ol><li>Driverç±»æ·»åŠ ç¼“å­˜æ–‡ä»¶ï¼š<code>job.addCacheFile(new URI)</code>ï¼›</li><li>è®¾ç½®ReduceTaskæ•°é‡ä¸º0ï¼š<code>job.setNumberReduceTasks(0)</code>ï¼›</li><li>Mapperç±»çš„setupæ–¹æ³•è¯»å–ç¼“å­˜æ–‡ä»¶å¹¶ä¿å­˜ä¸ºé›†åˆï¼›</li><li>mapæ–¹æ³•æ ¹æ®é›†åˆå’Œæ•°æ®å®Œæˆå…³è”åˆå¹¶ã€‚</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="etl"></a>ETL<a class="hash-link" href="#etl" title="Direct link to heading">#</a></h2><p>ETL(Extract-Transform-Load)æŒ‡æ•°æ®ä»æºç«¯ç»è¿‡æŠ½å–ã€è½¬æ¢å’ŒåŠ è½½åˆ°ç›®æ ‡ç«¯çš„è¿‡ç¨‹ï¼Œåœ¨è¿è¡Œæ ¸å¿ƒä¸šåŠ¡MapReduceç¨‹åºä¹‹å‰éƒ½éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—ï¼Œ<strong>ETLå¾€å¾€åªéœ€è¦è¿è¡ŒMapperè€Œä¸éœ€è¦Reducer</strong>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="å‹ç¼©"></a>å‹ç¼©<a class="hash-link" href="#å‹ç¼©" title="Direct link to heading">#</a></h2><p>Hadoopæ•°æ®å‹ç¼©çš„ä¼˜ç‚¹æ˜¯å‡å°‘IOæ¬¡æ•°ã€å‡å°‘å­˜å‚¨ç©ºé—´ï¼Œä½†ç¼ºç‚¹æ˜¯å¢åŠ CPUå¼€é”€ã€‚å› æ­¤ä½¿ç”¨å‹ç¼©çš„åŸåˆ™æ˜¯CPUå¯†é›†å‹åº”ç”¨å°‘ç”¨å‹ç¼©ï¼Œè€ŒIOå¯†é›†å‹åº”ç”¨å¤šç”¨å‹ç¼©ã€‚</p><table><thead><tr><th>å‹ç¼©æ ¼å¼</th><th>Hadoopæ˜¯å¦è‡ªå¸¦</th><th>ç®—æ³•</th><th>æ‰©å±•å</th><th>æ˜¯å¦å¯åˆ‡ç‰‡</th><th>æ˜¯å¦éœ€è¦ä¿®æ”¹ç¨‹åº</th></tr></thead><tbody><tr><td>DEFALTE</td><td>æ˜¯</td><td>DEFLATE</td><td>.deflate</td><td>å¦</td><td>å¦</td></tr><tr><td>GZIP</td><td>æ˜¯</td><td>DEFLATE</td><td>.gz</td><td>å¦</td><td>å¦</td></tr><tr><td>bzip2</td><td>æ˜¯</td><td>bzip2</td><td>.bz2</td><td><strong>æ˜¯</strong></td><td>å¦</td></tr><tr><td>LZO</td><td><strong>å¦</strong></td><td>LZO</td><td>.lzo</td><td><strong>æ˜¯</strong></td><td>éœ€è¦å»ºç´¢å¼•ï¼ŒæŒ‡å®šè¾“å…¥æ ¼å¼</td></tr><tr><td>snappy</td><td>æ˜¯</td><td>Snappy</td><td>.snappy</td><td>å¦</td><td>å¦</td></tr></tbody></table><p>å½“å‹ç¼©åº”ç”¨äºInputFormatï¼Œæ— é¡»æ˜¾ç¤ºæŒ‡å®šä½¿ç”¨çš„ç¼–ç æ–¹æ³•ï¼ŒHadoopä¼šè‡ªåŠ¨æ£€æŸ¥æ–‡ä»¶æ‰©å±•åé€‰æ‹©åˆé€‚çš„è§£ç¼–ç æ–¹å¼å¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©å’Œè§£å‹ã€‚åœ¨å¼€å‘ä¸­è‹¥æ•°æ®é‡å°äºå—å¤§å°ï¼Œé‡ç‚¹è€ƒè™‘å‹ç¼©å’Œè§£å‹æ¯”è¾ƒå¿«çš„LZO/Snappyï¼Œè‹¥æ•°æ®é‡éå¸¸å¤§ï¼Œé‡ç‚¹è€ƒè™‘æ”¯æŒåˆ‡ç‰‡çš„Bzip2å’ŒLZOã€‚å½“å‹ç¼©åº”ç”¨äºShuffleé˜¶æ®µï¼Œé‡ç‚¹è€ƒè™‘å‹ç¼©å’Œè§£å‹å¿«çš„LZO/Snappyã€‚å½“å‹ç¼©åº”ç”¨äºOutputFormatï¼Œå¦‚æœæ•°æ®æ°¸ä¹…ä¿å­˜åˆ™è€ƒè™‘å‹ç¼©ç‡é«˜çš„bzip2å’ŒGzipï¼Œå¦‚æœä½œä¸ºä¸‹ä¸€ä¸ªMapReduceç¨‹åºçš„è¾“å…¥ï¼Œéœ€è¦è€ƒè™‘æ˜¯å¦æ”¯æŒåˆ‡ç‰‡ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="å‹ç¼©é…ç½®"></a>å‹ç¼©é…ç½®<a class="hash-link" href="#å‹ç¼©é…ç½®" title="Direct link to heading">#</a></h3><table><thead><tr><th>å‚æ•°</th><th>é»˜è®¤å€¼</th><th>é˜¶æ®µ</th><th>å»ºè®®</th></tr></thead><tbody><tr><td>io.compression.codecs(core-site.xml)</td><td>æ— ï¼Œè¾“å…¥<code>hadoop checknative</code>æŸ¥çœ‹</td><td>è¾“å…¥å‹ç¼©</td><td></td></tr><tr><td>mapreduce.map.output.compress(mapred-site.xml)</td><td>false</td><td>mapperè¾“å‡º</td><td>è®¾ç½®ä¸ºtrueå¼€å¯å‹ç¼©</td></tr><tr><td>mapreduce.map.output.compress.codec(mapred-site.xml)</td><td>org.apache.hadoop.io.compress.DefaultCodec</td><td>mapperè¾“å‡º</td><td>è®¾ç½®LZOæˆ–Snappy</td></tr><tr><td>mapreduce.output.fileoutputformat.compress(mapred-site.xml)</td><td>false</td><td>reducerè¾“å‡º</td><td>è®¾ç½®ä¸ºtrueå¼€å¯å‹ç¼©</td></tr><tr><td>mapreduce.output.fileoutputformat.compress.codec(mapred-site.xml)</td><td>org.apache.hadoop.io.compress.DefaultCodec</td><td>reducerè¾“å‡º</td><td>ä½¿ç”¨gzipæˆ–bzip2</td></tr></tbody></table></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_3kfx"><div class="col"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/hadoop">Hadoop</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/big-data">BigData</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/kayhaw/kayhaw.github.io/edit/master/website/blog/blog/2022-01-31-Learning-Hadoop3.x-03.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2022/02/07/Learning-Hadoop3.x-04"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« Hadoop 3.xå­¦ä¹ ç¬”è®°(4)</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2022/01/30/Learning-Hadoop3.x-02"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Hadoop 3.xå­¦ä¹ ç¬”è®°(2) Â»</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#mapreduceç®€ä»‹" class="table-of-contents__link">MapReduceç®€ä»‹</a><ul><li><a href="#mapperç±»" class="table-of-contents__link">Mapperç±»</a></li><li><a href="#reducerç±»" class="table-of-contents__link">Reducerç±»</a></li><li><a href="#driverç±»" class="table-of-contents__link">Driverç±»</a></li></ul></li><li><a href="#åºåˆ—åŒ–" class="table-of-contents__link">åºåˆ—åŒ–</a></li><li><a href="#mapreduceæ¡†æ¶" class="table-of-contents__link">MapReduceæ¡†æ¶</a><ul><li><a href="#jobæäº¤æµç¨‹" class="table-of-contents__link">Jobæäº¤æµç¨‹</a></li><li><a href="#fileinputformatåˆ‡ç‰‡" class="table-of-contents__link">FileInputFormatåˆ‡ç‰‡</a></li><li><a href="#textinputformatå’Œcombinefileinputformat" class="table-of-contents__link">TextInputFormatå’ŒCombineFileInputFormat</a></li><li><a href="#shuffle" class="table-of-contents__link">Shuffle</a></li></ul></li><li><a href="#maptaskå·¥ä½œæœºåˆ¶" class="table-of-contents__link">MapTaskå·¥ä½œæœºåˆ¶</a><ul><li><a href="#maptaskæºç åˆ†æ" class="table-of-contents__link">MapTaskæºç åˆ†æ</a></li><li><a href="#reducetaskæºç åˆ†æ" class="table-of-contents__link">ReduceTaskæºç åˆ†æ</a></li></ul></li><li><a href="#join" class="table-of-contents__link">Join</a></li><li><a href="#etl" class="table-of-contents__link">ETL</a></li><li><a href="#å‹ç¼©" class="table-of-contents__link">å‹ç¼©</a><ul><li><a href="#å‹ç¼©é…ç½®" class="table-of-contents__link">å‹ç¼©é…ç½®</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">è¯»ä¹¦ç¬”è®°</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://www.zhihu.com/people/xiao-ke-dou-7" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>çŸ¥ä¹<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kayhaw" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://gitee.com/kayhaw" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 ä½•è½²(Kay Haw). Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ed6f7924.js"></script>
<script src="/assets/js/main.87f14a62.js"></script>
</body>
</html>