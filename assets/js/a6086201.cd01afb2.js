"use strict";(self.webpackChunkkayhaw_github_io=self.webpackChunkkayhaw_github_io||[]).push([[2098],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return d}});var a=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(t),d=i,k=u["".concat(s,".").concat(d)]||u[d]||m[d]||r;return t?a.createElement(k,o(o({ref:n},c),{},{components:t})):a.createElement(k,o({ref:n},c))}));function d(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=u;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},8929:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return p},assets:function(){return c},toc:function(){return m},default:function(){return d}});var a=t(7462),i=t(3366),r=(t(7294),t(3905)),o=["components"],l={title:"FlinkX\u6e90\u7801\u5256\u6790(1)",author:"\u4f55\u8f72",author_title:"Never settle down",author_url:"https://github.com/kayhaw",author_image_url:"https://avatars.githubusercontent.com/u/16892835?v=4",tags:["FlinkX","Source code dissection"],description:"FlinkX\u6e90\u7801\u5256\u6790(1)",hide_table_of_contents:!1},s=void 0,p={permalink:"/blog/2022/01/09/FlinkX-Source-Code-Dissection-01",editUrl:"https://github.com/kayhaw/kayhaw.github.io/edit/master/website/blog/blog/2022-01-09-FlinkX-Source-Code-Dissection-01.md",source:"@site/blog/2022-01-09-FlinkX-Source-Code-Dissection-01.md",title:"FlinkX\u6e90\u7801\u5256\u6790(1)",description:"FlinkX\u6e90\u7801\u5256\u6790(1)",date:"2022-01-09T00:00:00.000Z",formattedDate:"January 9, 2022",tags:[{label:"FlinkX",permalink:"/blog/tags/flink-x"},{label:"Source code dissection",permalink:"/blog/tags/source-code-dissection"}],readingTime:3.765,truncated:!0,authors:[{name:"\u4f55\u8f72",title:"Never settle down",url:"https://github.com/kayhaw",imageURL:"https://avatars.githubusercontent.com/u/16892835?v=4"}],prevItem:{title:"drift",permalink:"/blog/drift"},nextItem:{title:"MySQL\u57fa\u7840\u77e5\u8bc6\u603b\u7ed3(1)",permalink:"/blog/2021/10/26/MySQLSummary"}},c={authorsImageUrls:[void 0]},m=[{value:"\u542f\u52a8\u811a\u672c",id:"\u542f\u52a8\u811a\u672c",children:[]},{value:"\u547d\u4ee4\u884c\u5165\u53e3Launcher",id:"\u547d\u4ee4\u884c\u5165\u53e3launcher",children:[{value:"\u53c2\u6570\u89e3\u6790",id:"\u53c2\u6570\u89e3\u6790",children:[]},{value:"\u9ed8\u8ba4\u53c2\u6570\u914d\u7f6e",id:"\u9ed8\u8ba4\u53c2\u6570\u914d\u7f6e",children:[]},{value:"\u53c2\u6570\u8f6c\u4e3aString\u5217\u8868",id:"\u53c2\u6570\u8f6c\u4e3astring\u5217\u8868",children:[]}]},{value:"FlinkX\u6267\u884c\u5165\u53e3Main.main()",id:"flinkx\u6267\u884c\u5165\u53e3mainmain",children:[{value:"\u521b\u5efa\u6d41\u6267\u884c\u73af\u5883",id:"\u521b\u5efa\u6d41\u6267\u884c\u73af\u5883",children:[]},{value:"\u6267\u884c\u4f5c\u4e1aexeSyncJob",id:"\u6267\u884c\u4f5c\u4e1aexesyncjob",children:[]}]},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",children:[]}],u={toc:m};function d(e){var n=e.components,t=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\ud83d\udcddFlinkX\u6e90\u7801\u5256\u6790(1)\uff1a\u4e3b\u6d41\u7a0b\u5206\u6790\u3002\u4ee5local\u6a21\u5f0f\u8fd0\u884c\u4e3a\u4f8b\u5206\u6790FlinkX\u4e3b\u6d41\u7a0b\u6267\u884c\u903b\u8f91\uff1a\u4ece\u8fd0\u884c\u811a\u672c\u5f00\u59cb\u5230\u914d\u7f6e\u53c2\u6570\u7684\u89e3\u6790\u3001",(0,r.kt)("strong",{parentName:"p"},"\u63d2\u4ef6\u7c7b\u52a0\u8f7d"),"\uff0c\u6700\u540e\u5230Flink\u6d41\u5e94\u7528\u6784\u5efa\u6267\u884c\u3002\u4ee3\u7801\u6ce8\u91ca\u89c1",(0,r.kt)("a",{parentName:"p",href:"https://github.com/kayhaw/flinkx/tree/1.12_release_dissection"},(0,r.kt)("img",{parentName:"a",src:"https://img.shields.io/badge/flinkx-1.12__release__dissection-blue",alt:"FlinkX Dissection"})),"\u3002"),(0,r.kt)("h2",{id:"\u542f\u52a8\u811a\u672c"},"\u542f\u52a8\u811a\u672c"),(0,r.kt)("p",null,"FlinkX\u63d0\u4f9b\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"bin/flinkx"),"\u811a\u672c\u7528\u4e8e\u5728\u547d\u4ee4\u884c\u5feb\u901f\u542f\u52a8\u540c\u6b65\u4efb\u52a1\uff0c\u5b83\u672c\u8d28\u4e0a\u5c31\u662f\u4e00\u4e2ajava\u547d\u4ee4\u7684\u5c01\u88c5\uff0c\u4f46\u8fd8\u662f\u8981\u5c55\u5f00\u6765\u4ed4\u7ec6\u5730\u8bb2\u8bb2\u5b83\u7528\u5230\u7684\u4e00\u4e9bbash\u77e5\u8bc6\u3002"),(0,r.kt)("p",null,"\u9996\u5148\u7b2c\u4e00\u884c",(0,r.kt)("inlineCode",{parentName:"p"},"set -e"),"\uff0c\u4f5c\u7528\u662f\u8ba9\u811a\u672c\u6267\u884c\u9519\u8bef\u65f6\u7acb\u5373\u9000\u51fa\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6267\u884c\u547d\u4ee4\u9519\u8bef\u540e\u4f1a\u7ee7\u7eed\u6267\u884c\uff0c\u5efa\u8bae\u5728\u6240\u6709\u811a\u672c\u5934\u90e8\u90fd\u52a0\u4e0a\u3002\u63a5\u4e0b\u6765\u8fd9\u4e2a\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u7684\u4ee3\u7801\u5c31\u5f88\ud83d\ude0f\u4e86\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'export FLINKX_HOME="$(cd "`dirname "$0"`"/..; pwd)"\n')),(0,r.kt)("p",null,"\u4ece\u5916\u5230\u5185\u5206\u6790\uff0c\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"$()"),"\u6267\u884c2\u6761\u547d\u4ee4",(0,r.kt)("inlineCode",{parentName:"p"},'cd "`dirname "$0"`"/..'),"\u548c",(0,r.kt)("inlineCode",{parentName:"p"},"pwd"),"\u3002\u7b2c\u4e00\u6761cd\u547d\u4ee4\u7684\u53c2\u6570\u53c8\u7531\u547d\u4ee4",(0,r.kt)("inlineCode",{parentName:"p"},'`dirname "$0"`'),"\u7ed9\u51fa\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"dirname"),"\u662fbash\u5185\u7f6e\u547d\u4ee4\uff0c\u8f93\u51fa\u540e\u9762\u53c2\u6570\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u8def\u5f84\uff0c\u800c\u53c2\u6570",(0,r.kt)("inlineCode",{parentName:"p"},'"$0"'),"\u8868\u793a\u811a\u672c\u6587\u4ef6",(0,r.kt)("inlineCode",{parentName:"p"},"flinkx"),"\u3002\u7ed3\u5408\u8d77\u6765\u7684\u542b\u4e49\u5c31\u662f\u5207\u6362\u5230flinkx\u8fd9\u4e2a\u811a\u672c\u6587\u4ef6\u6240\u5728\u7684\u7236\u76ee\u5f55bin\u4e0b\uff0c\u7136\u540e\u518d\u5207\u6362\u5230\u4e0a\u4e00\u5c42\u76ee\u5f55\u5230\u9879\u76ee\u76ee\u5f55\uff0c\u6700\u540e\u6253\u5370\u7edd\u5bf9\u8def\u5f84\uff0c\u5373\u8bbe\u7f6e\u7528\u6237\u53d8\u91cfFLINKX_HOME\u4e3a\u9879\u76ee\u6587\u4ef6\u5939\u7684\u7edd\u5bf9\u8def\u5f84\u3002"),(0,r.kt)("ul",{className:"contains-task-list"},(0,r.kt)("li",{parentName:"ul",className:"task-list-item"},(0,r.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","set\u3001env\u3001export\u7684\u533a\u522b")),(0,r.kt)("p",null,"\u63a5\u4e0b\u6765\u770b\u5f53\u524d\u7cfb\u7edf\u80fd\u4e0d\u80fd\u4f7f\u7528java\u7a0b\u5e8f\uff0c\u5148\u770b",(0,r.kt)("inlineCode",{parentName:"p"},"JAVA_HOME"),"\u73af\u5883\u662f\u5426\u5b58\u5728\uff0c\u82e5\u4e0d\u5b58\u5728\u518d\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"command -v java"),"\u770b\u80fd\u4e0d\u80fd\u76f4\u63a5\u6267\u884cjava\u7a0b\u5e8f\uff0c\u518d\u6ca1\u6709\u5c31\u62a5\u9519\u9000\u51fa\u3002\u63a5\u4e0b\u6765\u8bbe\u7f6e\u4e24\u4e2ashell\u53d8\u91cf",(0,r.kt)("inlineCode",{parentName:"p"},"JAR_DIR"),"\u548c\u5165\u53e3\u7c7b\u540d",(0,r.kt)("inlineCode",{parentName:"p"},"CLASS_NAME"),"\uff0c\u7136\u540e\u6267\u884c\u547d\u4ee4\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"nohup $JAVA_RUN -cp $JAR_DIR $CLASS_NAME $@ &\n")),(0,r.kt)("p",null,"nohup\u547d\u4ee4\u662fno hang up\u547d\u4ee4\u7684\u7f29\u5199\uff0c\u5b83\u5c06\u540e\u9762\u8ddf\u7740\u7684\u547d\u4ee4\u6302\u5230\u540e\u53f0\u8fd0\u884c\u5e76\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230nohup.out\u6587\u4ef6\uff0c\u901a\u5e38\u8ddf",(0,r.kt)("inlineCode",{parentName:"p"},"&"),"\u642d\u914d\u4f7f\u7528\uff0c\u8ba9\u547d\u4ee4\u6267\u884c\u540c\u65f6\u5ffd\u7565SIGINT\u548cSIGHUP\u4fe1\u53f7\u3002\u53d8\u91cf\u66ff\u6362\u540e\u7684\u547d\u4ee4\u5982\u4e0b\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"$@"),"\u8868\u793a\u6267\u884cflinkx\u811a\u672c\u540e\u9762\u8ddf\u7740\u7684\u6240\u6709\u53c2\u6570\u3002"),(0,r.kt)("ul",{className:"contains-task-list"},(0,r.kt)("li",{parentName:"ul",className:"task-list-item"},(0,r.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","nohup\u548c&\u7684\u533a\u522b"),(0,r.kt)("li",{parentName:"ul",className:"task-list-item"},(0,r.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ",(0,r.kt)("inlineCode",{parentName:"li"},"$@"),"\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"$#"),"\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"$1"),"...",(0,r.kt)("inlineCode",{parentName:"li"},"$n"),"\u7684\u542b\u4e49")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"java -cp /path-to-flinkx/lib/* com.dtstack.flinkx.client.Launcher $@\n")),(0,r.kt)("p",null,"\u4ee5\u8fd0\u884c\u4e00\u4e2aMySQL\u5230Hive\u7684\u540c\u6b65\u4efb\u52a1\u4e3a\u4f8b\uff0c\u5728Linux\u6267\u884c\u547d\u4ee4\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"bin/flinkx -mode local   \\\n         -jobType sync \\\n         -jobName test_kayhaw \\\n         -job E:\\flinkx_job\\new_mysql_hive.json \\\n         -flinkxDistDir E:\\flinkx\\flinkx-dist \\\n")),(0,r.kt)("p",null,"\u5728IEDA\u8fd0\u884cFlinkX\u540c\u6b65\u4efb\u52a1\u914d\u7f6e\u8fd0\u884c\u53c2\u6570\u547d\u4ee4\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5176\u4e2dProgram arguments\u5185\u5bb9\u5373\u4e0a\u8ff0\u547d\u4ee4\u53c2\u6570\u5185\u5bb9\u3002"),(0,r.kt)("img",{style:{width:"100%",height:"100%"},src:"/img/blog/FlinkXDissection/FlinkX_IDEA_RunConfig.png",title:"FlinkX IDEA Run Configuration"}),(0,r.kt)("h2",{id:"\u547d\u4ee4\u884c\u5165\u53e3launcher"},"\u547d\u4ee4\u884c\u5165\u53e3Launcher"),(0,r.kt)("p",null,"\u4ece",(0,r.kt)("inlineCode",{parentName:"p"},"bin/flinx"),"\u811a\u672c\u5f97\u77e5\u8be5\u547d\u4ee4\u884c\u8fd0\u884c\u5165\u53e3\u4e3aLauncher\u7c7b\uff0c\u5b83\u4f4d\u4e8eflinkx-clients\u6a21\u5757\uff0c\u63a5\u4e0b\u6765\u5bf9\u5176main\u65b9\u6cd5\u5c55\u5f00\u5206\u6790\u3002"),(0,r.kt)("h3",{id:"\u53c2\u6570\u89e3\u6790"},"\u53c2\u6570\u89e3\u6790"),(0,r.kt)("p",null,"\u9996\u5148\u5bf9\u547d\u4ee4\u540e\u9762\u7684\u4e00\u5927\u5768\u53c2\u6570\u8fdb\u884c\u89e3\u6790\uff0c\u501f\u52a9\u4e8eApache Commons CLI\u5305\u6765\u5b8c\u6210\u3002\u4e3a\u4e86\u5c06\u53c2\u6570\u5b57\u7b26\u4e32\u8f6c\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"com.dtstack.flinkx.options.Options"),"\u5bf9\u8c61\uff0c\u4f7f\u7528\u53cd\u5c04\u83b7\u53d6Options\u7684\u5b57\u6bb5\uff0c\u7ed3\u5408Common CLI\u63d0\u4f9b\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"DefaultParser.parse()"),"\u65b9\u6cd5\u5c06\u5b57\u7b26\u4e32\u8f6c\u4e3aCommandLine\u5bf9\u8c61\uff0c\u7136\u540e\u518d\u904d\u5386Options\u7684\u5b57\u6bb5\u540d\u79f0name\uff0c\u901a\u8fc7",(0,r.kt)("inlineCode",{parentName:"p"},"CommandLine.getOptionValue(name)"),"\u83b7\u53d6\u53c2\u6570\u503c\uff0c\u6700\u540e\u8bbe\u7f6e\u56de\u7ed9Options\u5bf9\u8c61\u3002"),(0,r.kt)("h3",{id:"\u9ed8\u8ba4\u53c2\u6570\u914d\u7f6e"},"\u9ed8\u8ba4\u53c2\u6570\u914d\u7f6e"),(0,r.kt)("p",null,"\u63a5\u4e0b\u6765findDefaultConfigDir()\u65b9\u6cd5\u7528\u4e8e\u5728\u547d\u4ee4\u884c\u6ca1\u6709\u63d0\u4f9b\u7684\u60c5\u51b5\u4e0b\uff0c\u8bbe\u7f6e3\u4e2a\u6587\u4ef6\u5939\u8def\u5f84\u53c2\u6570\u9ed8\u8ba4\u503c\uff0c\u5206\u522b\u662fFlinkX\u8bfb\u5199\u63d2\u4ef6\u5305\u6587\u4ef6\u5939\u3001Flink\u914d\u7f6e\u6587\u4ef6\u5939\u548cHadoop\u914d\u7f6e\u6587\u4ef6\u5939\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"private static void findDefaultConfigDir(Options launcherOptions) {\n    findDefaultFlinkxDistDir(launcherOptions);\n\n    // local\u6a21\u5f0f\u53ea\u9700\u8981\u914d\u7f6eFlinkXDistDir\u8fd9\u4e00\u4e2a\u5c31\u53ef\u4ee5\n    if (ClusterMode.local.name().equalsIgnoreCase(launcherOptions.getMode())) {\n        return;\n    }\n\n    findDefaultFlinkConf(launcherOptions);\n    findDefaultHadoopConf(launcherOptions);\n}\n")),(0,r.kt)("p",null,"\u4ee5findDefaultFlinkxDistDir()\u4ee3\u7801\u4e3a\u4f8b\uff1a\u5f53\u547d\u4ee4\u884c\u53c2\u6570\u6ca1\u6709flinkDistDir\u65f6\uff0c\u770b\u73af\u5883\u53d8\u91cf\u4e2d\u6709\u6ca1\u6709\u914d\u7f6e",(0,r.kt)("inlineCode",{parentName:"p"},"FLINX_HOME"),"\uff0c\u8fd9\u4e2a\u67e5\u770b\u73af\u5883\u53d8\u91cf\u65b9\u6cd5getSystemProperty()\u4e5f\u6709\u8bb2\u7a76\uff0c\u5148\u8c03\u7528System.getenv()\u770b\u6709\u6ca1\u6709\uff0c\u6ca1\u6709\u518d\u770bSystem.getProperty()\u3002\u5982\u679c\u6709\u73af\u5883\u53d8\u91cf",(0,r.kt)("inlineCode",{parentName:"p"},"FLINKX_HOME"),"\uff0c\u6839\u636e\u5b83\u8bbe\u7f6eflinkx\u63d2\u4ef6\u5305\u8def\u5f84\uff0c\u5e76\u6ce8\u518c\u4e3a\u73af\u5883\u53d8\u91cf",(0,r.kt)("inlineCode",{parentName:"p"},"ConfigConstants.ENV_FLINK_PLUGINS_DIR"),"\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"private static void findDefaultFlinkxDistDir(Options launcherOptions) {\n    String distDir = launcherOptions.getFlinkxDistDir();\n    // \u5982\u679c\u8fd0\u884c\u53c2\u6570\u8fd8\u672a\u8bbe\u7f6e\uff0c\u901a\u8fc7\u7cfb\u7edf\u53d8\u91cf\u6765\u81ea\u5df1\u627e\n    if (StringUtils.isEmpty(distDir)) {\n        String flinkxHome = getSystemProperty(KEY_FLINKX_HOME);\n        if (StringUtils.isNotEmpty(flinkxHome)) {\n            flinkxHome = flinkxHome.trim();\n            // \u8fd8\u8003\u8651\u5230\u8def\u5f84\u6700\u672b\u5c3e\u6709\u6ca1\u6709\u52a0\u8def\u5f84\u5206\u9694\u7b26\uff0c\u7ec6\uff01\n            if (flinkxHome.endsWith(File.separator)) {\n                distDir = flinkxHome + PLUGINS_DIR_NAME;\n            } else {\n                distDir = flinkxHome + File.separator + PLUGINS_DIR_NAME;\n            }\n\n            launcherOptions.setFlinkxDistDir(distDir);\n        }\n    }\n    System.setProperty(ConfigConstants.ENV_FLINK_PLUGINS_DIR, distDir);\n}\n")),(0,r.kt)("p",null,"findDefaultFlinkConf()\u65b9\u6cd5\u5728\u6709\u73af\u5883\u53d8\u91cfFLIN",(0,r.kt)("strong",{parentName:"p"},"K"),"_HOME\u8bbe\u7f6e\u7684\u60c5\u51b5\u4e0b\uff0c\u8865\u5145\u8bbe\u7f6eFlink\u7684conf\u76ee\u5f55\u548clib\u76ee\u5f55\u53c2\u6570\u3002findDefaultHadoopConf()\u65b9\u6cd5\u7c7b\u4f3c\u67e5\u770bHADOOP_HOME\u73af\u5883\u53d8\u91cf\u5e76\u8bbeHadoop conf\u76ee\u5f55\u53c2\u6570\u3002"),(0,r.kt)("h3",{id:"\u53c2\u6570\u8f6c\u4e3astring\u5217\u8868"},"\u53c2\u6570\u8f6c\u4e3aString\u5217\u8868"),(0,r.kt)("p",null,"\u8fd9\u4e00\u90e8\u5206\u7684\u4ee3\u7801\u6709\u70b9\u8ff7\uff0c\u9996\u5148\u8c03\u7528getProgramExeArgList()\u65b9\u6cd5\u628a\u89e3\u6790\u597d\u7684Options\u53c2\u6570\u5bf9\u8c61\u8f6c\u4e3aString\u5217\u8868\uff0c\u5177\u4f53\u64cd\u4f5c\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u67e5\u770b",(0,r.kt)("inlineCode",{parentName:"li"},"-job"),"\u9009\u9879\u914d\u7f6e\uff0c",(0,r.kt)("strong",{parentName:"li"},"\u628a\u6587\u4ef6\u8def\u5f84\u5b57\u7b26\u4e32\u66ff\u6362\u4e3a\u6587\u4ef6\u5185\u5bb9\u5b57\u7b26\u4e32"),"\uff0c\u8fd9\u4e2a\u903b\u8f91\u85cf\u5f97\u6709\u70b9\u6df1\uff1b"),(0,r.kt)("li",{parentName:"ol"},'\u67e5\u770b\u6bcf\u4e2a\u9009\u9879\u540d\uff0c\u52a0\u4e0a"-"\u524d\u7f00\u52a0\u5165String\u5217\u8868\uff0c\u518d\u52a0\u5165\u9009\u9879\u503c\uff0c\u5f62\u6210\u4e24\u4e24\u4e00\u5bf9\u7684\u5217\u8868\u3002')),(0,r.kt)("p",null,"\u63a5\u4e0b\u6765\u628a\u8fd9\u4e2aString\u5217\u8868\u653e\u5230HashMap\u4e2d\u4fbf\u4e8e\u6309\u952e\u83b7\u53d6\uff0c\u7136\u540e\u53d6\u51fa",(0,r.kt)("inlineCode",{parentName:"p"},"-p"),"\u9009\u9879\u503cs\uff0c\u8fd9\u662fFlinkX\u63d0\u4f9b\u7684\u7279\u6027\uff0cs\u662f",(0,r.kt)("inlineCode",{parentName:"p"},'"\u53c2\u6570\u540d1=\u53c2\u6570\u503c1,\u53c2\u6570\u540d2=\u53c2\u6570\u503c2..."'),"\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\uff0c\u62c6\u89e3\u6210\u952e\u503c\u5bf9\uff0c\u7528\u4e8e\u66ff\u6362",(0,r.kt)("inlineCode",{parentName:"p"},"-job"),"\u53c2\u6570\u503cjson\u5b57\u7b26\u4e32\u4e2d\u7c7b\u4f3c",(0,r.kt)("inlineCode",{parentName:"p"},"${name}"),'\u7684\u5360\u4f4d\u7b26\u3002\u6bd4\u5982s="name=kay"\uff0cjson\u5b57\u7b26\u4e32\u4e3a',(0,r.kt)("inlineCode",{parentName:"p"},'{"name": "${name}"}'),"\uff0c\u7ed3\u679c\u66ff\u6362\u540ejson\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},'{"name": "kayhaw"}'),"\u3002"),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"\u771f\u7684\u597d\u5417\uff1f")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"\u8fd9\u91cc\u4e3a\u4e86\u5b9e\u73b0",(0,r.kt)("inlineCode",{parentName:"p"},"-p"),"\u53c2\u6570\u63d0\u4f9b\u7684\u7279\u6027\uff0c\u628aOptions\u8f6c\u4e3aString\u5217\u8868\uff0c\u53c8\u8f6c\u4e3aHashMap\uff0c\u8fd9\u6837\u6765\u56de\u5012\u817e\uff0c\u4e0d\u5982\u4e00\u5f00\u59cb\u4eceOptions\u91cc\u53d6\u51fajob\u6587\u4ef6\u540d\u548cs\uff0c\u7136\u540e\u8bfb\u53d6json\u6587\u4ef6\u5185\u5bb9\u4e3aString\uff0c\u7136\u540e\u518d\u66ff\u6362\u53d8\u91cf\uff0c\u53ef\u4ee5\u7701\u7565\u6ca1\u6709\u610f\u4e49\u7684\u8f6c\u4e3aHashMap\u548cString\u5217\u8868\u3002"))),(0,r.kt)("p",null,"\u63a5\u7740\u6784\u9020JobDeployer\u5bf9\u8c61\uff0c\u5c31\u662fOptions\u5bf9\u8c61\u548c\u53d8\u91cf\u66ff\u6362\u540e\u53c2\u6570\u5217\u8868\u7684\u5c01\u88c5\u3002\u7136\u540e\u6839\u636e\u53c2\u6570",(0,r.kt)("inlineCode",{parentName:"p"},"-mode"),"\u7684\u7c7b\u578b\u6784\u9020\u5bf9\u5e94\u7684xxxClusterClientHelper\u5bf9\u8c61\uff0c\u7531\u4e8e\u4ee5local\u6a21\u5f0f\u8fd0\u884c\uff0c\u5bf9\u5e94\u4e3aLocalClusterClientHelper\u5bf9\u8c61\u3002"),(0,r.kt)("p",null,"\u7136\u540e\u6dfb\u52a0",(0,r.kt)("inlineCode",{parentName:"p"},"-addJar"),"\u53c2\u6570\u6307\u5b9a\u7684\u6269\u5c55\u5305\uff0c\u6211\u4eec\u6ca1\u6709\u63d0\u4f9b\uff0c\u8df3\u8fc7\u3002\u6700\u540e\u6267\u884cLocalClusterClientHelper\u7684submit\u65b9\u6cd5\uff0c\u81f3\u6b64Launcher\u7c7b\u5df2\u7ecf\u5b8c\u6210\u4e86\u5b83\u7684\u4f7f\u547d\u3002"),(0,r.kt)("h2",{id:"flinkx\u6267\u884c\u5165\u53e3mainmain"},"FlinkX\u6267\u884c\u5165\u53e3Main.main()"),(0,r.kt)("p",null,"LocalClusterClientHelper\u7684\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff0c\u5b83\u7684\u903b\u8f91\u5f88\u7b80\u5355\uff1a\u628aJobDeployer\u8f6c\u4e3a\u5b57\u7b26\u4e32\u5217\u8868args(\u5367\u69fd\uff0c\u6ce5\u5728\u8d63\u795e\u9b54\uff01\ud83d\ude20\uff0c\u53c8\u56de\u5230\u5b57\u7b26\u4e32\u4e86)\uff0c\u7136\u540e\u6267\u884cMain.main(args)\u65b9\u6cd5(flinkx-core\u6a21\u5757\u4e0b)\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java",metastring:"title=LocalClusterClientHelper.java",title:"LocalClusterClientHelper.java"},"public class LocalClusterClientHelper implements ClusterClientHelper {\n    @Override\n    public ClusterClient submit(JobDeployer jobDeployer) throws Exception {\n        // \u4ececlients.Launcher\u7684main\u65b9\u6cd5\u5230core\u5305\u4e0bMain\u7c7b\u7684main\u65b9\u6cd5\n        // \u53c8\u628a\u5bf9\u8c61\u8f6c\u6210\u4e86\u7ed9main\u65b9\u6cd5\u7684args\u5b57\u7b26\u4e32\u6570\u7ec4\n        String[] args = jobDeployer.getProgramArgs().toArray(new String[0]);\n        Main.main(args);\n        return null;\n    }\n}\n")),(0,r.kt)("p",null,"Main.main()\u65b9\u6cd5\u4ee3\u7801\u5982\u4e0b\uff1a\u9996\u5148\u53c8\u628a\u4f20\u5165\u7684\u5b57\u7b26\u4e32\u8f6c\u4e3aOptions\u5bf9\u8c61\uff0c\u5e76\u4e14\u7ed9job\u5b57\u7b26\u4e32\u6309UF-8\u91cd\u65b0\u7f16\u7801\uff0c\u9632\u6b62\u540e\u7eed\u4f7f\u7528gson\u8f6c\u4e3ajson\u5bf9\u8c61\u65f6\u51fa\u9519\u3002\u63a5\u7740\u83b7\u53d6",(0,r.kt)("inlineCode",{parentName:"p"},"-confProp"),"\u53c2\u6570\u503c\uff0c\u6211\u4e48\u6ca1\u6709\u7ed9\u51fa\uff0c\u8df3\u8fc7\u3002\u63a5\u7740\u4f7f\u7528EnvFactory\u5de5\u5382\u7c7b\u5206\u522b\u521b\u5efa\u666e\u901a\u7684\u6d41\u6267\u884c\u73af\u5883env\u548c\u8868\u6267\u884c\u73af\u5883tEnv(\u53ef\u662f\u4f7f\u7528\u66f4\u52a0\u7075\u6d3b\u7684SQL\u800c\u4e0d\u662fjson)\uff0c\u7531\u4e8e\u63d0\u4f9b\u7684\u4efb\u52a1\u7c7b\u578b\u4e3async\uff0c\u56e0\u6b64\u8fdb\u5165\u5230exeSyncJob\u65b9\u6cd5\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java",metastring:"title=flinkx-core/src/main/java/com/dtstack/flinkx/Main.java",title:"flinkx-core/src/main/java/com/dtstack/flinkx/Main.java"},'public static void main(String[] args) throws Exception {\n    LOG.info("------------program params-------------------------");\n    Arrays.stream(args).forEach(arg -> LOG.info("{}", arg));\n    LOG.info("-------------------------------------------");\n\n    // \u53c8\u628astring\u5b57\u7b26\u4e32\u8f6c\u4e3aOptions\u5bf9\u8c61\n    Options options = new OptionParser(args).getOptions();\n    // \u5c06json\u5b57\u7b26\u4e32\u91cd\u65b0\u7f16\u7801\u4e3aUTF-8\uff0c\u540e\u9762gson\u89e3\u6790\u9700\u8981\n    String job = URLDecoder.decode(options.getJob(), Charsets.UTF_8.name());\n    // \u73af\u5883\u53d8\u91cf\uff0c\u53ea\u7528\u4e8etable\u6267\u884c\u73af\u5883\n    Properties confProperties = PropertiesUtil.parseConf(options.getConfProp());\n    // env\u7528\u4e8e\u6267\u884c\u666e\u901a\u540c\u6b65\u4efb\u52a1\n    StreamExecutionEnvironment env = EnvFactory.createStreamExecutionEnvironment(options);\n    // tenv\u7528\u4e8e\u6267\u884cflink sql\u540c\u6b65\u4efb\u52a1\uff0c\u4f9d\u8d56\u4e8eenv\n    StreamTableEnvironment tEnv =\n            EnvFactory.createStreamTableEnvironment(env, confProperties, options.getJobName());\n\n    switch (EJobType.getByName(options.getJobType())) {\n        case SQL:\n            exeSqlJob(env, tEnv, job, options);\n            break;\n            // \u5176\u5b9e\u6211\u89c9\u5f97\u8fd9\u91cc\u53ef\u4ee5\u6539\u540d\u53ebJSON\n        case SYNC:\n            // \u5f00\u59cb\u6b63\u5f0f\u6267\u884c\n            exeSyncJob(env, tEnv, job, options);\n            break;\n        default:\n            throw new FlinkxRuntimeException(\n                    "unknown jobType: ["\n                            + options.getJobType()\n                            + "], jobType must in [SQL, SYNC].");\n    }\n\n    LOG.info("program {} execution success", options.getJobName());\n}\n')),(0,r.kt)("h3",{id:"\u521b\u5efa\u6d41\u6267\u884c\u73af\u5883"},"\u521b\u5efa\u6d41\u6267\u884c\u73af\u5883"),(0,r.kt)("p",null,"EnvFactory\u5de5\u5382\u7c7b\u7684createStreamExecutionEnvironment\u548ccreateStreamTableEnvironment\u65b9\u6cd5\u5206\u522b\u7528\u4e8e\u521b\u5efa\u666e\u901a\u7684\u6d41\u6267\u884c\u73af\u5883env\u548c\u4ee5\u8868\u5f62\u5f0f\u7684\u6267\u884c\u73af\u5883tEnv\u3002\u4ee5\u524d\u8005\u4e3a\u4f8b\u5206\u6790\uff0c\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public static StreamExecutionEnvironment createStreamExecutionEnvironment(Options options) {\n    Configuration flinkConf = new Configuration();\n    if (StringUtils.isNotEmpty(options.getFlinkConfDir())) {\n        // \u7ed9\u51faflink conf\u6587\u4ef6\u5939\u8def\u5f84\u5e76\u52a0\u8f7d\uff0cloadConfiguration\u91cd\u8f7d\u7248\u672c\u8fd8\u53ef\u4ee5\u518d\u52a0\u4e00\u4e2aConfiguration\u5bf9\u8c61\u6765\u8865\u5145\u914d\u7f6e\n        flinkConf = GlobalConfiguration.loadConfiguration(options.getFlinkConfDir());\n    }\n    StreamExecutionEnvironment env;\n    if (StringUtils.equalsIgnoreCase(ClusterMode.local.name(), options.getMode())) {\n        // local\u6a21\u5f0f\u4e0b\uff0c\u8fd0\u884c\u53c2\u6570-flinkConfDir=path_to_flink_conf\u7ed9\u51fa\u672c\u5730flink\u914d\u7f6e\u76ee\u5f55\u7684\u8def\u5f84\n        // \u8fdb\u800c\u914d\u7f6eflink\u6267\u884c\u73af\u5883\n        env = new MyLocalStreamEnvironment(flinkConf);\n    } else {\n        // \u5176\u4ed6\u8fd0\u884c\u6a21\u5f0f\u4e0b\uff0c\u8fd0\u884c\u53c2\u6570-confProp=<json\u5b57\u7b26\u4e32>\u7ed9\u51fa\u6765\u914d\u7f6eflink\u6267\u884c\u73af\u5883\n        Configuration cfg =\n                Configuration.fromMap(PropertiesUtil.confToMap(options.getConfProp()));\n        env = StreamExecutionEnvironment.getExecutionEnvironment(cfg);\n    }\n    // \u5173\u95ed\u95ed\u5305\u6e05\u7406\uff0cuser code\u5df2\u7ecf\u5728\u6bcf\u4e2aworker\u8282\u70b9\u4e0b\uff1f\n    env.getConfig().disableClosureCleaner();\n    return env;\n}\n")),(0,r.kt)("p",null,"\u9996\u5148\u8c03\u7528GlobalConfiguration.loadConfiguration(String conf_dir)\u65b9\u6cd5\u5f97\u5230\u914d\u7f6e\u7c7b\uff0c\u8be5\u65b9\u6cd5\u7531Flink Core\u5305\u63d0\u4f9b\uff0c\u7528\u4e8e\u89e3\u6790\u67d0\u4e2a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u914d\u7f6e\u6587\u4ef6\u4e3aConfiguration\u5bf9\u8c61flinkConf\u3002\u5982\u679c\u662flocal\u6a21\u5f0f\u63d0\u4ea4\u4efb\u52a1\uff0c\u4f7f\u7528flinkConf\u914d\u7f6e\u751f\u6210\u7684MyLocalStreamEnvironment\uff0c\u8be5\u7c7b\u662fFlinkX\u81ea\u5b9a\u4e49\u7684\u3002\u5176\u4ed6\u6a21\u5f0f\u4e0b\uff0c\u73af\u5883\u7684\u914d\u7f6e\u53c2\u6570\u7531",(0,r.kt)("inlineCode",{parentName:"p"},"-confProp"),"\u6307\u5b9a\u3002"),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"local\u6a21\u5f0f\u63d0\u4ea4\u4efb\u52a1\u5219\u4f7f\u7528\u672c\u5730\u7684FlinkX conf\u76ee\u5f55\u4e0b\u914d\u7f6e\u6587\u4ef6\u4f5c\u4e3a\u6d41\u6267\u884c\u73af\u5883\u7684\u914d\u7f6e\uff0c\u5176\u4ed6\u6a21\u5f0f\u8fdc\u7a0b\u63d0\u4ea4\u5230Flink\u96c6\u7fa4\uff0c\u6b64\u65f6\u901a\u8fc7",(0,r.kt)("inlineCode",{parentName:"p"},"-confProp"),"\u53c2\u6570\u63d0\u4f9b\u989d\u5916\u7684\u6267\u884c\u73af\u5883\u914d\u7f6e\u3002"))),(0,r.kt)("p",null,"\u63a5\u7740\u8c03\u7528disableClosureCleaner()\u65b9\u6cd5\u5173\u95ed\u95ed\u5305\u6e05\u7406\u5668\u529f\u80fd(\u9ed8\u8ba4\u5f00\u542f)\uff0c\u4ec0\u4e48\u662fClosureCleaner\uff1fFlink Java API Doc\u7ed9\u51fa\u7684\u89e3\u91ca\u5982\u4e0b\uff1a"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The closure cleaner is a utility that tries to truncate the closure (enclosing instance) of non-static inner classes (created for inline transformation functions). That makes non-static inner classes in many cases serializable, where Java's default behavior renders them non-serializable without good reason.")),(0,r.kt)("p",null,"\u5728Java\u7f16\u7a0b\u4e2d\uff0c\u5185\u90e8\u7c7b\u6240\u5728\u7684\u5916\u90e8\u7c7b\u79f0\u4e4b\u4e3a\u95ed\u5305(closure)\u3002\u5f53\u5f00\u542f\u95ed\u5305\u6e05\u7406\uff0cFlink\u4f1a\u5206\u6790\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u4e2d\u6ca1\u6709\u7528\u5230\u7684\u5b57\u6bb5\uff0c\u5e76\u5c06\u5176\u8bbe\u7f6e\u4e3anull\uff0c\u8fd9\u6837\u4f7f\u5f97\u95ed\u5305\u6216\u8005\u533f\u540d\u5185\u90e8\u7c7b\u662f\u53ef\u5e8f\u5217\u5316\u7684\uff0c\u800c\u67d0\u4e9bJava\u5de5\u5177\u5305\u4e0d\u4f1a\u5c06\u5176\u5e8f\u5217\u5316\u3002\u800c\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u9700\u8981\u901a\u8fc7\u5e8f\u5217\u5316\u5c06\u5176\u5206\u53d1\u5230Flink\u96c6\u7fa4\u7684worker\u8282\u70b9\u4e0a\u3002\u8fd9\u91cc\u5173\u95ed\u4e86\u95ed\u5305\u6e05\u7406\uff0c\u662f\u56e0\u4e3a\u5df2\u7ecf\u5728\u5404\u4e2a\u8282\u70b9\u4e0a\u90e8\u7f72\u4e86FlinkX jar\u5305\ud83e\udd14\uff1f"),(0,r.kt)("h3",{id:"\u6267\u884c\u4f5c\u4e1aexesyncjob"},"\u6267\u884c\u4f5c\u4e1aexeSyncJob"),(0,r.kt)("p",null,"Main.exeSyncJob()\u65b9\u6cd5\u7684\u4ee3\u7801\u903b\u8f91\u53ef\u4ee5\u5206\u4e3a\u5982\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7b2c\u4e00\u6b65"),"\uff0c\u89e3\u6790\u547d\u4ee4\u884c\u53c2\u6570\u5f97\u5230\u914d\u7f6e\u7c7b\u5bf9\u8c61SyncConf\uff0c\u901a\u8fc7GSON.fromJson()\u65b9\u6cd5\u89e3\u6790\uff0c",(0,r.kt)("strong",{parentName:"p"},"\u987a\u4fbf\u505a\u4e86\u53c2\u6570\u975e\u7a7a\u6821\u9a8c"),"\uff1b"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7b2c\u4e8c\u6b65"),"\uff0c\u7531configStreamExecutionEnvironment\u65b9\u6cd5\u914d\u7f6e\u6d41\u6267\u884c\u73af\u5883\uff0c\u5176\u4e2d\u6838\u5fc3\u4ee3\u7801\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"PluginUtil.registerPluginUrlToCachedFile(config, env)"),"\uff0c\u5c55\u5f00\u5206\u6790\u4e00\u4e0b\u8fd9\u4e2a\u65b9\u6cd5(\u5f88\u91cd\u8981\uff01)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public static void registerPluginUrlToCachedFile(\n            SyncConf config, StreamExecutionEnvironment env) {\n    Set<URL> urlSet = new HashSet<>();\n    // \u8fd9\u91cc\u56fa\u5b9a\u6b7b\u4e86\u8fdc\u7a0b\u63d2\u4ef6\u5305\u8def\u5f84\u4e3anull\uff0cgetJarFileDirPath\u4e5f\u53ea\u4f1a\u53d6\u672c\u5730\u63d2\u4ef6\u5305\u8def\u5f84\u4e86\n    Set<URL> coreUrlList = getJarFileDirPath("", config.getPluginRoot(), null);\n    Set<URL> formatsUrlList = getJarFileDirPath(FORMATS_SUFFIX, config.getPluginRoot(), null);\n    Set<URL> sourceUrlList =\n            getJarFileDirPath(\n                    config.getReader().getName(),\n                    // \u6ce8\u610f\u8fd9\u91cc\u63d2\u4ef6\u641c\u7d22\u6839\u8def\u5f84\u6362\u4e86\uff0c\u5728connector\u76ee\u5f55\u4e0b\u9762\u627e\uff0csink\u540c\u7406\n                    config.getPluginRoot() + SP + CONNECTOR_DIR_NAME,\n                    null);\n    Set<URL> sinkUrlList =\n            getJarFileDirPath(\n                    config.getWriter().getName(),\n                    config.getPluginRoot() + SP + CONNECTOR_DIR_NAME,\n                    null);\n    Set<URL> metricUrlList =\n            getJarFileDirPath(\n                    config.getMetricPluginConf().getPluginName(),\n                    // \u6307\u6807\u63d2\u4ef6\u5728metrics\u76ee\u5f55\u4e0b\u9762\u627e\n                    config.getPluginRoot() + SP + METRIC_SUFFIX,\n                    null);\n    urlSet.addAll(coreUrlList);\n    urlSet.addAll(formatsUrlList);\n    urlSet.addAll(sourceUrlList);\n    urlSet.addAll(sinkUrlList);\n    urlSet.addAll(metricUrlList);\n\n    int i = 0;\n    for (URL url : urlSet) {\n        String classFileName = String.format(CLASS_FILE_NAME_FMT, i);\n        // \u6ce8\u518c\u6240\u6709\u7684jar\u5305\n        env.registerCachedFile(url.getPath(), classFileName, true);\n        i++;\n    }\n    \n    // \u5982\u679c\u662f\u672c\u5730\u6267\u884c\u73af\u5883\u5219\u76f4\u63a5\u52a0\u8f7d\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u52a0\u8f7d\u81ea\u5df1\u7684\n    if (env instanceof MyLocalStreamEnvironment) {\n        ((MyLocalStreamEnvironment) env).setClasspaths(new ArrayList<>(urlSet));\n        if (CollectionUtils.isNotEmpty(coreUrlList)) {\n            try {\n                ClassLoader contextClassLoader = Thread.currentThread().getContextClassLoader();\n                // \u4e3a\u4ec0\u4e48\u8981\u7528\u53cd\u5c04\u52a0\u8f7djar\u5305\uff1f\uff1f\uff1f\n                Method add = URLClassLoader.class.getDeclaredMethod("addURL", URL.class);\n                add.setAccessible(true);\n                add.invoke(contextClassLoader, new ArrayList<>(coreUrlList).get(0));\n            } catch (Exception e) {\n                LOG.warn(\n                        "cannot add core jar into contextClassLoader, coreUrlList = {}",\n                        GsonUtil.GSON.toJson(coreUrlList),\n                        e);\n            }\n        }\n    }\n}\n')),(0,r.kt)("p",null,"\u8be5\u65b9\u6cd5\u4e3b\u8981\u529f\u80fd\u662f\u901a\u8fc7getJarFileDirPath\u5f97\u5230\u4e0d\u540c\u529f\u80fd\u63d2\u4ef6\u5305\u7684URL\u5217\u8868\uff0c\u7136\u540e\u5c06\u6240\u6709URL\u5217\u8868\u5408\u5e76\uff0c\u6700\u540e\u901a\u8fc7Flink\u63d0\u4f9b\u7684\u65b9\u6cd5registerCachedFile(String filePath, String name, boolean executable)\u5c06jar\u6587\u4ef6\u6ce8\u518c\u5230\u7f13\u5b58\u4e2d\u3002getJarFileDirPath\u7684\u4ee3\u7801\u903b\u8f91\u5982\u4e0b\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5c06\u8bfb\u5199\u63d2\u4ef6\u540d\u79f0\u4e2d\u7684",(0,r.kt)("inlineCode",{parentName:"li"},"reader"),"\u3001",(0,r.kt)("inlineCode",{parentName:"li"},"source"),"\u3001",(0,r.kt)("inlineCode",{parentName:"li"},"writer"),"\u548c",(0,r.kt)("inlineCode",{parentName:"li"},"sink"),"\u8fd94\u4e2d\u540e\u7f00\u53bb\u6389\u5f97\u5230\u63d2\u4ef6\u540d\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u641c\u7d22",(0,r.kt)("inlineCode",{parentName:"li"},"<FlinkX\u63d2\u4ef6\u5305\u76ee\u5f55>/connector/<\u63d2\u4ef6\u540d>"),"\u4e0b\u7684",(0,r.kt)("strong",{parentName:"li"},"\u6240\u6709\u4ee5flinkx\u5f00\u5934\uff0c\u4ee5.jar\u7ed3\u5c3e\u7684\u6587\u4ef6\u540d"),"\uff0c\u5373\u8bfb\u5199\u63d2\u4ef6jar\u5305\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u8fd4\u56de\u6587\u4ef6URL\u3002")),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"\u6ce8\u610f")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"\u8fd9\u91ccgetJarFileDirPath\u7684\u7b2c3\u4e2a\u53c2\u6570\uff0cremotePluginPath\u4f20\u5165\u4e3anull\uff0c\u5426\u5219\u4f18\u5148\u4ece\u8be5\u8def\u5f84\u4e0b\u641c\u7d22jar\u6587\u4ef6"))),(0,r.kt)("p",null,"\u5f53\u7ed9env\u6ce8\u518c\u5b8c\u7f13\u5b58\u6587\u4ef6\u540e\uff0c\u5982\u679c\u8fd8\u662flocal\u6a21\u5f0f\uff0c\u5219\u52a0\u8f7dflinkx core\u5305\uff1a",(0,r.kt)("strong",{parentName:"p"},"\u4f7f\u7528\u7ebf\u7a0b\u52a0\u8f7d\u5668\uff0c\u5e76\u4ee5\u53cd\u5c04\u5f62\u5f0f\u8c03\u7528\u5176addURL\u65b9\u6cd5()"),"\u3002\u8fd9\u91cc\u4f7f\u7528\u53cd\u5c04\u662f\u56e0\u4e3aaddURL\u65b9\u6cd5\u662fURLClassLoader\u7c7b\u7684\uff0cClassLoader\u7c7b\u5e76\u6ca1\u6709\u8be5\u65b9\u6cd5\u3002\u5728\u8fd0\u884c\u65f6\uff0c\u83b7\u5f97\u7684\u7ebf\u7a0b\u52a0\u8f7d\u5668\u672c\u8d28\u662fAppClassLoader\uff0c\u5b83\u662fURLClassLoader\u7684\u5b50\u7c7b\u3002"),(0,r.kt)("p",null,"\u56de\u5230configStreamExecutionEnvironment\u65b9\u6cd5\uff0c\u5982\u679c\u89e3\u6790\u51fa\u6765\u7684\u914d\u7f6eSyncConf\u4e3a\u7a7a(-job\u53c2\u6570\u6ca1\u6709\u63d0\u4f9b)\uff0c\u5e76\u4e14\u8fd0\u884c\u6a21\u5f0f\u4e0d\u662flocal\u6216\u8005\u63d2\u4ef6\u52a0\u8f7d\u6a21\u5f0f\u4e0d\u662fshipfile(\u53c2\u6570-shipfile\u4e3a1)\u5c31\u629b\u51fa\u5f02\u5e38\uff0c\u5426\u5219\u6784\u9020\u4e00\u4e2aFactoryHelper\u6ce8\u518c\u5230FactoryUtil\u548cTableFactoryService\u7684ThreadLocal\u5bf9\u8c61(\u7531\u4e8e\u8fd0\u884c\u6a21\u5f0f\u4e3alocal\uff0c\u8fd9\u6b65\u64cd\u4f5c\u7684\u4f5c\u7528\u5148\u7565\u8fc7)\u3002"),(0,r.kt)("p",null,"\u6700\u540e\u4e00\u6b65\u662fregisterShipfileToCachedFile\u65b9\u6cd5\uff0c\u4e0a\u9762registerPluginUrlToCachedFile\u65b9\u6cd5\u4e0d\u540c\u7684\u662f\uff0c",(0,r.kt)("strong",{parentName:"p"},"\u5b83\u5728\u8c03\u7528env.registerCachedFile()\u65b9\u6cd5\u65f6\u7b2c3\u4e2a\u53c2\u6570\u8bbe\u7f6e\u4e3afalse"),"\u3002"),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"registerPluginUrlToCachedFile\u548cregisterShipfileToCachedFile\u7684\u4e0d\u540c\uff1a"),(0,r.kt)("ol",{parentName:"div"},(0,r.kt)("li",{parentName:"ol"},"\u6ce8\u518c\u5bf9\u8c61\u4e0d\u540c\uff0c\u524d\u8005\u662fflinx-dist\u4e0b\u7684\u63d2\u4ef6jar\u5305\uff0c\u540e\u8005\u662f\u53c2\u6570",(0,r.kt)("inlineCode",{parentName:"li"},"-shipfile"),"\u503c(\u4ee5\u9017\u53f7\u5206\u9694\u7684jar\u5305\u8def\u5f84)\u63d0\u4f9b\u7684jar\u5305\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u6ce8\u518c\u65b9\u5f0f\u4e0d\u540c\uff0c\u524d\u8005\u6ce8\u518c\u540d\u4e3a",(0,r.kt)("inlineCode",{parentName:"li"},"class_path_<\u5e8f\u53f7>"),"\uff0c\u540e\u8005\u4ee5jar\u6587\u4ef6\u540d\u6ce8\u518c\u56e0\u6b64\u4e0d\u80fd\u91cd\u540d\uff1b\u524d\u8005executable\u53c2\u6570\u4e3atrue\uff0c\u540e\u8005\u4e3afalse\u3002")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7b2c\u4e09\u6b65"),"\uff1a\u8c03\u7528discoverSource\u65b9\u6cd5\u83b7\u53d6SourceFactory\u5b9e\u4f8b\u3002\u9996\u5148\u7531 PluginUtil.getPluginClassName\u65b9\u6cd5\u786e\u5b9a\u8981\u5b9e\u4f8b\u5316\u7684\u5168\u8def\u5f84\u5de5\u5382\u7c7b\u540d\uff0c\u5176\u6784\u9020\u683c\u5f0f\u4e3a",(0,r.kt)("strong",{parentName:"p"},"com.dtstack.flinkx.connector.<\u63d2\u4ef6\u540d>.source.<\u9996\u5b57\u6bcd\u5927\u5199\u63d2\u4ef6\u540d>SourceFactory"),"\uff1b\u63a5\u7740\u901a\u8fc7getJarFileDirPath\u641c\u7d22",(0,r.kt)("inlineCode",{parentName:"p"},"${FLINK_DIST_DIR}/connector/<\u63d2\u4ef6\u540d>"),"\u7684jar\u6587\u4ef6\u548cformat\u76ee\u5f55\u4e0b\u7684jar\u6587\u4ef6\uff0c\u5408\u5e76\u6210urlList\u5217\u8868\u3002\u901a\u8fc7Flink API\u914d\u7f6e\u6267\u884c\u73af\u5883\uff0c\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'ConfigUtils.encodeCollectionToConfig(\n        // \u4e3a\u4ec0\u4e48\u4e0d\u80fd\u76f4\u63a5env.getConfig()\u800c\u662f\u8981\u901a\u8fc7\u53cd\u5c04\uff1f\n        (Configuration)\n                ReflectionUtils.getDeclaredMethod(env, "getConfiguration").invoke(env),\n        // \u8fd9\u662f\u7528\u4e8epipeline\u7684jar\u5305\n        PipelineOptions.JARS,\n        urlList,\n        URL::toString);\nConfigUtils.encodeCollectionToConfig(\n        (Configuration)\n                ReflectionUtils.getDeclaredMethod(env, "getConfiguration").invoke(env),\n        PipelineOptions.CLASSPATHS,\n        urlList,\n        URL::toString);\n')),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"\u4e3a\u4ec0\u4e48\u7528\u53cd\u5c04\u8c03\u7528getConfiguration\u65b9\u6cd5\uff1f")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"getConfiguration\u65b9\u6cd5\u662fStreamExecutionEnvironment\u7684protected\u65b9\u6cd5\uff0c\u4e0d\u80fd\u76f4\u63a5\u8c03\u7528\u3002"))),(0,r.kt)("p",null,"\u6700\u540e\u8c03\u7528\u7c7b\u52a0\u8f7d\u5668\u52a0\u8f7d\u5de5\u5382\u7c7b\u5e76\u8c03\u7528\u5176\u7279\u5b9a\u7684\u6784\u9020\u65b9\u6cd5\u8fd4\u56de\u5b9e\u4f8b\uff0c\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"return ClassLoaderManager.newInstance(\n    // \u4e3a\u4ec0\u4e48\u4f20\u5165urlList\uff1f\u5b83\u4f5c\u4e3akey\u6765\u6807\u8bc6\u4e4b\u524d\u4f7f\u7528\u7684classloader\n    urlList,\n    // cl\u662fclassload\u7f29\u5199\n    cl -> {\n        Class<?> clazz = cl.loadClass(pluginClassName);\n        Constructor<?> constructor =\n                clazz.getConstructor(\n                        SyncConf.class, StreamExecutionEnvironment.class);\n        // \u8c03\u7528\u7279\u5b9a\u7684\u6784\u9020\u65b9\u6cd5\u8fd4\u56deSourceFactory\u5bf9\u8c61\n        return (SourceFactory) constructor.newInstance(config, env);\n    });\n")),(0,r.kt)("p",null,"\u8fd9\u91cc\u4e4b\u6240\u4ee5\u4f1a\u4f20\u5165urlList\u5217\u8868\uff0c\u662f\u56e0\u4e3aClassLoaderManager\u4ee5url\u4e3akey\u7ef4\u62a4\u4e86\u4e00\u4e2aClassLoader\u5bf9\u8c61\u7f13\u5b58HashMap\uff0c\u901a\u8fc7lambda\u8868\u8fbe\u5f0f\u6267\u884c\u7c7b\u52a0\u8f7d\u548c\u5b9e\u4f8b\u5316\uff0c\u6ce8\u610f\u4f7f\u7528cl\u65f6\u9700\u8981\u5207\u6362\u5f53\u524d\u7c7b\u52a0\u8f7d\u5668\uff0c\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public static <R> R callbackAndReset(\n        ClassLoaderSupplier<R> supplier, ClassLoader toSetClassLoader) throws Exception {\n    // \u6682\u65f6\u5730\u5c06\u7ebf\u7a0b\u7c7b\u52a0\u8f7d\u5668\u66ff\u6362\u4e3atoSetClassLoader\uff0c\u7136\u540e\u8c03\u7528supplier.get\u65b9\u6cd5\n    ClassLoader oldClassLoader = Thread.currentThread().getContextClassLoader();\n    Thread.currentThread().setContextClassLoader(toSetClassLoader);\n    try {\n        return supplier.get(toSetClassLoader);\n    } finally {\n        // \u8fd8\u539f\u65e7\u7684\n        Thread.currentThread().setContextClassLoader(oldClassLoader);\n    }\n}\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7b2c\u56db\u6b65"),"\uff1a\u901a\u8fc7sourceFactory.createSource()\u5f97\u5230DataStream<RowData",">","\uff0c\u7136\u540e\u8bbe\u7f6esource\u7b97\u5b50\u5e76\u884c\u5ea6\u3002\u8fd9\u90e8\u5206\u5185\u5bb9\u6d89\u53casource\u7b97\u5b50\u7684\u5b9e\u73b0\uff0c\u5728\u4e0b\u4e00\u7bc7\u6587\u7ae0\u4e2d\u5206\u6790\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7b2c\u4e94\u6b65"),"\uff1a\u6839\u636ejson\u914d\u7f6etransformer\u5c06\u6d41\u73af\u5883\u8f6c\u4e3a\u8868\u73af\u5883\uff0c\u7531syncStreamToTable\u5b9e\u73b0\uff0c\u7531\u4e8e\u672a\u63d0\u4f9btransform sql\uff0c\u5148\u8df3\u8fc7\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7b2c\u516d\u6b65"),"\uff1a\u6839\u636e\u914d\u7f6e\u8bbe\u7f6e\u4ecesource\u5230sink\u7b97\u5b50\u7684\u5206\u53d1\u7b56\u7565\u4e3arealance()\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7b2c\u4e03\u6b65"),"\uff1a\u6784\u9020SinkFactory\u5bf9\u8c61\u5e76\u8c03\u7528createSink\u65b9\u6cd5\u521b\u5efasink\u7b97\u5b50\uff0c\u7136\u540e\u6839\u636e\u914d\u7f6e\u8bbe\u7f6e\u5176\u5e76\u884c\u5ea6\uff0c\u903b\u8f91\u540csource\u7b97\u5b50\uff0c\u8df3\u8fc7\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7b2c\u516b\u6b65"),"\uff1a\u6267\u884c\u4f5c\u4e1a\uff0c\u4f5c\u4e1a\u540d\u79f0\u7531\u53c2\u6570",(0,r.kt)("inlineCode",{parentName:"p"},"-jobName"),"\u7ed9\u51fa\u3002\u5982\u679c\u662flocal\u6a21\u5f0f\u8fd0\u884c\u8fd8\u4f1a\u6253\u7edf\u8ba1\u6307\u6807\u7ed3\u679c\u3002"),(0,r.kt)("p",null,"\u81f3\u6b64\uff0cFlinkX\u540c\u6b65\u4efb\u52a1\u63d0\u4ea4\u7684\u4e3b\u5e72\u6d41\u7a0b\u5206\u6790\u5b8c\u6bd5\u3002"),(0,r.kt)("h2",{id:"\u603b\u7ed3"},"\u603b\u7ed3"),(0,r.kt)("p",null,"\u4e3b\u5e72\u6d41\u7a0b\u53ef\u4ee5\u5f52\u7eb3\u4e3a3\u4e2a\u65b9\u9762\u7684\u529f\u80fd\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u8fd0\u884c\u53c2\u6570\u7684\u9ed8\u8ba4\u8bbe\u7f6e\u3001\u89e3\u6790\u548c\u4efb\u52a1json\u53d8\u91cf\u66ff\u6362\u7b49\u64cd\u4f5c"),(0,r.kt)("li",{parentName:"ol"},"\u6d41\u6267\u884c\u73af\u5883\u7684\u914d\u7f6e\uff0c\u7528\u5230\u7684Flink API\u6709\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"// 1. \u6307\u5b9a\u914d\u7f6e\u76ee\u5f55\u89e3\u6790\u5f97\u5230Configuration\nGlobalConfiguration.loadConfiguration(String configDir)\n// 2. \u6ce8\u518c\u7f13\u5b58jar\u6587\u4ef6\nStreamExecutionEnvironment.registerCachedFile(String filePath, \n    String name, boolean executable)\n// 3. \u7528\u4e8e\u914d\u7f6epipeline.jars\u548cpipeline.classpaths\u53c2\u6570\u7684\u5de5\u5177\u65b9\u6cd5\nConfigUtils.encodeCollectionToConfig(WritableConfig configuration\uff0c ConfigOption<List<OUT>> key, \n    @Nullable Collection<IN> values, Function<IN, OUT> mapper)\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"\u521b\u5efasource\u548csink\u7b97\u5b50\uff0c\u5148\u7528\u53cd\u5c04\u673a\u5236\u6784\u9020\u5de5\u5382\u7c7b\uff0c\u7136\u540e\u901a\u8fc7\u5de5\u5382\u7c7b\u793a\u4f8b\u521b\u5efa\u7b97\u5b50\u5b9e\u4f8b\u3002")),(0,r.kt)("p",null,"\u6267\u884c\u73af\u5883\u914d\u7f6e\u548c\u7b97\u5b50\u90fd\u5df2\u51c6\u5907\u597d\uff0c\u8c03\u7528StreamExecutionEnvironment.execute()\u5373\u53ef\u6267\u884c\u4efb\u52a1\u3002\u603b\u4f53\u4e0b\u6765\u53c2\u6570\u914d\u7f6e\u7684\u51c6\u5907\u5de5\u4f5c\u5c45\u591a\uff0c\u6700\u6838\u5fc3\u90e8\u5206\u5c31\u662f\u914d\u7f6e\u8fd0\u884c\u73af\u5883\u3001\u52a0\u8f7d\u7b97\u5b50\u5de5\u5382\u7c7b\u7136\u540e\u521b\u5efa\u7b97\u5b50\u3002"))}d.isMDXComponent=!0}}]);